Starting scenario 4, validation against site 0
2021-03-10 15:58:59.812134: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /nopt/slurm/current/lib:/nopt/slurm/current/lib:
2021-03-10 15:58:59.812164: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Cross validation site: 0
Training sites: [1, 2, 3, 4, 5, 6, 7, 8]
Number of files: 8
Number of east files: 4
Number of west files: 4
Source files: ['/projects/mlclouds/data_surfrad_9/2016_east_adj/mlclouds_surfrad_2016.h5', '/projects/mlclouds/data_surfrad_9/2016_west_adj/mlclouds_surfrad_2016.h5', '/projects/mlclouds/data_surfrad_9/2017_east_adj/mlclouds_surfrad_2017.h5', '/projects/mlclouds/data_surfrad_9/2017_west_adj/mlclouds_surfrad_2017.h5', '/projects/mlclouds/data_surfrad_9/2018_east_adj/mlclouds_surfrad_2018.h5', '/projects/mlclouds/data_surfrad_9/2018_west_adj/mlclouds_surfrad_2018.h5', '/projects/mlclouds/data_surfrad_9/2019_east_adj/mlclouds_surfrad_2019.h5', '/projects/mlclouds/data_surfrad_9/2019_west_adj/mlclouds_surfrad_2019.h5']
Full config: {'clean_training_data_kwargs': {'filter_clear': False, 'nan_option': 'interp'}, 'epochs_a': 100, 'epochs_b': 100, 'features': ['solar_zenith_angle', 'cloud_type', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo'], 'hidden_layers': [{'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}], 'learning_rate': 0.001, 'loss_weights_a': [1, 0], 'loss_weights_b': [0.5, 0.5], 'metric': 'relative_mae', 'n_batch': 64, 'one_hot_categories': {'flag': ['clear', 'ice_cloud', 'water_cloud', 'bad_cloud']}, 'p_fun': 'p_fun_all_sky', 'p_kwargs': {'loss_terms': ['mae_ghi']}, 'phygnn_seed': 0, 'surfrad_window_minutes': 15, 'y_labels': ['cld_opd_dcomp', 'cld_reff_dcomp']}
INFO - 2021-03-10 15:59:09,205 [trainer.py:37] : Trainer: Training on sites [1, 2, 3, 4, 5, 6, 7, 8] from files ['/projects/mlclouds/data_surfrad_9/2016_east_adj/mlclouds_surfrad_2016.h5', '/projects/mlclouds/data_surfrad_9/2016_west_adj/mlclouds_surfrad_2016.h5', '/projects/mlclouds/data_surfrad_9/2017_east_adj/mlclouds_surfrad_2017.h5', '/projects/mlclouds/data_surfrad_9/2017_west_adj/mlclouds_surfrad_2017.h5', '/projects/mlclouds/data_surfrad_9/2018_east_adj/mlclouds_surfrad_2018.h5', '/projects/mlclouds/data_surfrad_9/2018_west_adj/mlclouds_surfrad_2018.h5', '/projects/mlclouds/data_surfrad_9/2019_east_adj/mlclouds_surfrad_2019.h5', '/projects/mlclouds/data_surfrad_9/2019_west_adj/mlclouds_surfrad_2019.h5']
INFO - 2021-03-10 15:59:09,206 [trainer.py:46] : Trainer: Training on sites [1, 2, 3, 4, 5, 6, 7, 8] from files ['/projects/mlclouds/data_surfrad_9/2016_east_adj/mlclouds_surfrad_2016.h5', '/projects/mlclouds/data_surfrad_9/2016_west_adj/mlclouds_surfrad_2016.h5', '/projects/mlclouds/data_surfrad_9/2017_east_adj/mlclouds_surfrad_2017.h5', '/projects/mlclouds/data_surfrad_9/2017_west_adj/mlclouds_surfrad_2017.h5', '/projects/mlclouds/data_surfrad_9/2018_east_adj/mlclouds_surfrad_2018.h5', '/projects/mlclouds/data_surfrad_9/2018_west_adj/mlclouds_surfrad_2018.h5', '/projects/mlclouds/data_surfrad_9/2019_east_adj/mlclouds_surfrad_2019.h5', '/projects/mlclouds/data_surfrad_9/2019_west_adj/mlclouds_surfrad_2019.h5']
INFO - 2021-03-10 15:59:09,206 [data_handlers.py:58] : Loading training data
DEBUG - 2021-03-10 15:59:09,206 [data_handlers.py:76] : Loading vars ['solar_zenith_angle', 'cloud_type', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'cld_opd_dcomp', 'cld_reff_dcomp']
DEBUG - 2021-03-10 15:59:09,206 [data_handlers.py:83] : Loading data for site(s) [1, 2, 3, 4, 5, 6, 7, 8], from /projects/mlclouds/data_surfrad_9/2016_east_adj/mlclouds_surfrad_2016.h5
DEBUG - 2021-03-10 15:59:10,289 [data_handlers.py:101] : 	Shape temp_raw=(140544, 19), temp_all_sky=(140544, 14)
DEBUG - 2021-03-10 15:59:10,292 [data_handlers.py:104] : 	Time step is 30 minutes
DEBUG - 2021-03-10 15:59:10,293 [data_handlers.py:108] : 	Grabbing surface data for 2016 and [1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2021-03-10 15:59:10,315 [data_handlers.py:115] : 		Grabbing surface data for tbl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/tbl_2016.h5
DEBUG - 2021-03-10 15:59:11,003 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:11,006 [data_handlers.py:115] : 		Grabbing surface data for dra from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/dra_2016.h5
DEBUG - 2021-03-10 15:59:11,684 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:11,687 [data_handlers.py:115] : 		Grabbing surface data for fpk from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/fpk_2016.h5
DEBUG - 2021-03-10 15:59:12,390 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:12,393 [data_handlers.py:115] : 		Grabbing surface data for gwn from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/gwn_2016.h5
DEBUG - 2021-03-10 15:59:13,173 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:13,176 [data_handlers.py:115] : 		Grabbing surface data for psu from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/psu_2016.h5
DEBUG - 2021-03-10 15:59:13,860 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:13,863 [data_handlers.py:115] : 		Grabbing surface data for sxf from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sxf_2016.h5
DEBUG - 2021-03-10 15:59:14,548 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:14,551 [data_handlers.py:115] : 		Grabbing surface data for sgp from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sgp_2016.h5
DEBUG - 2021-03-10 15:59:15,325 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:15,328 [data_handlers.py:115] : 		Grabbing surface data for srrl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/srrl_2016.h5
DEBUG - 2021-03-10 15:59:16,020 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:16,020 [data_handlers.py:83] : Loading data for site(s) [1, 2, 3, 4, 5, 6, 7, 8], from /projects/mlclouds/data_surfrad_9/2016_west_adj/mlclouds_surfrad_2016.h5
DEBUG - 2021-03-10 15:59:16,956 [data_handlers.py:101] : 	Shape temp_raw=(140544, 19), temp_all_sky=(140544, 14)
DEBUG - 2021-03-10 15:59:16,959 [data_handlers.py:104] : 	Time step is 30 minutes
DEBUG - 2021-03-10 15:59:16,959 [data_handlers.py:108] : 	Grabbing surface data for 2016 and [1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2021-03-10 15:59:16,962 [data_handlers.py:115] : 		Grabbing surface data for tbl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/tbl_2016.h5
DEBUG - 2021-03-10 15:59:17,619 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:17,622 [data_handlers.py:115] : 		Grabbing surface data for dra from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/dra_2016.h5
DEBUG - 2021-03-10 15:59:18,277 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:18,280 [data_handlers.py:115] : 		Grabbing surface data for fpk from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/fpk_2016.h5
DEBUG - 2021-03-10 15:59:18,950 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:18,953 [data_handlers.py:115] : 		Grabbing surface data for gwn from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/gwn_2016.h5
DEBUG - 2021-03-10 15:59:19,607 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:19,610 [data_handlers.py:115] : 		Grabbing surface data for psu from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/psu_2016.h5
DEBUG - 2021-03-10 15:59:20,261 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:20,264 [data_handlers.py:115] : 		Grabbing surface data for sxf from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sxf_2016.h5
DEBUG - 2021-03-10 15:59:20,914 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:20,917 [data_handlers.py:115] : 		Grabbing surface data for sgp from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sgp_2016.h5
DEBUG - 2021-03-10 15:59:21,569 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:21,572 [data_handlers.py:115] : 		Grabbing surface data for srrl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/srrl_2016.h5
DEBUG - 2021-03-10 15:59:22,222 [data_handlers.py:127] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2021-03-10 15:59:22,222 [data_handlers.py:83] : Loading data for site(s) [1, 2, 3, 4, 5, 6, 7, 8], from /projects/mlclouds/data_surfrad_9/2017_east_adj/mlclouds_surfrad_2017.h5
DEBUG - 2021-03-10 15:59:23,172 [data_handlers.py:101] : 	Shape temp_raw=(140160, 19), temp_all_sky=(140160, 14)
DEBUG - 2021-03-10 15:59:23,175 [data_handlers.py:104] : 	Time step is 30 minutes
DEBUG - 2021-03-10 15:59:23,175 [data_handlers.py:108] : 	Grabbing surface data for 2017 and [1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2021-03-10 15:59:23,178 [data_handlers.py:115] : 		Grabbing surface data for tbl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/tbl_2017.h5
DEBUG - 2021-03-10 15:59:23,910 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:23,913 [data_handlers.py:115] : 		Grabbing surface data for dra from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/dra_2017.h5
DEBUG - 2021-03-10 15:59:24,576 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:24,579 [data_handlers.py:115] : 		Grabbing surface data for fpk from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/fpk_2017.h5
DEBUG - 2021-03-10 15:59:25,245 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:25,248 [data_handlers.py:115] : 		Grabbing surface data for gwn from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/gwn_2017.h5
DEBUG - 2021-03-10 15:59:25,923 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:25,926 [data_handlers.py:115] : 		Grabbing surface data for psu from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/psu_2017.h5
DEBUG - 2021-03-10 15:59:26,613 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:26,616 [data_handlers.py:115] : 		Grabbing surface data for sxf from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sxf_2017.h5
DEBUG - 2021-03-10 15:59:27,291 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:27,294 [data_handlers.py:115] : 		Grabbing surface data for sgp from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sgp_2017.h5
DEBUG - 2021-03-10 15:59:27,982 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:27,985 [data_handlers.py:115] : 		Grabbing surface data for srrl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/srrl_2017.h5
DEBUG - 2021-03-10 15:59:28,668 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:28,668 [data_handlers.py:83] : Loading data for site(s) [1, 2, 3, 4, 5, 6, 7, 8], from /projects/mlclouds/data_surfrad_9/2017_west_adj/mlclouds_surfrad_2017.h5
DEBUG - 2021-03-10 15:59:29,613 [data_handlers.py:101] : 	Shape temp_raw=(140160, 19), temp_all_sky=(140160, 14)
DEBUG - 2021-03-10 15:59:29,616 [data_handlers.py:104] : 	Time step is 30 minutes
DEBUG - 2021-03-10 15:59:29,616 [data_handlers.py:108] : 	Grabbing surface data for 2017 and [1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2021-03-10 15:59:29,619 [data_handlers.py:115] : 		Grabbing surface data for tbl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/tbl_2017.h5
DEBUG - 2021-03-10 15:59:30,273 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:30,276 [data_handlers.py:115] : 		Grabbing surface data for dra from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/dra_2017.h5
DEBUG - 2021-03-10 15:59:30,925 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:30,928 [data_handlers.py:115] : 		Grabbing surface data for fpk from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/fpk_2017.h5
DEBUG - 2021-03-10 15:59:31,572 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:31,575 [data_handlers.py:115] : 		Grabbing surface data for gwn from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/gwn_2017.h5
DEBUG - 2021-03-10 15:59:32,223 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:32,226 [data_handlers.py:115] : 		Grabbing surface data for psu from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/psu_2017.h5
DEBUG - 2021-03-10 15:59:32,895 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:32,898 [data_handlers.py:115] : 		Grabbing surface data for sxf from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sxf_2017.h5
DEBUG - 2021-03-10 15:59:33,544 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:33,547 [data_handlers.py:115] : 		Grabbing surface data for sgp from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sgp_2017.h5
DEBUG - 2021-03-10 15:59:34,208 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:34,211 [data_handlers.py:115] : 		Grabbing surface data for srrl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/srrl_2017.h5
DEBUG - 2021-03-10 15:59:34,853 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:34,853 [data_handlers.py:83] : Loading data for site(s) [1, 2, 3, 4, 5, 6, 7, 8], from /projects/mlclouds/data_surfrad_9/2018_east_adj/mlclouds_surfrad_2018.h5
DEBUG - 2021-03-10 15:59:40,435 [data_handlers.py:101] : 	Shape temp_raw=(840960, 19), temp_all_sky=(840960, 14)
DEBUG - 2021-03-10 15:59:40,448 [data_handlers.py:104] : 	Time step is 5 minutes
DEBUG - 2021-03-10 15:59:40,448 [data_handlers.py:108] : 	Grabbing surface data for 2018 and [1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2021-03-10 15:59:40,452 [data_handlers.py:115] : 		Grabbing surface data for tbl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/tbl_2018.h5
DEBUG - 2021-03-10 15:59:41,117 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:41,120 [data_handlers.py:115] : 		Grabbing surface data for dra from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/dra_2018.h5
DEBUG - 2021-03-10 15:59:41,781 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:41,784 [data_handlers.py:115] : 		Grabbing surface data for fpk from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/fpk_2018.h5
DEBUG - 2021-03-10 15:59:42,450 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:42,453 [data_handlers.py:115] : 		Grabbing surface data for gwn from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/gwn_2018.h5
DEBUG - 2021-03-10 15:59:43,117 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:43,120 [data_handlers.py:115] : 		Grabbing surface data for psu from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/psu_2018.h5
DEBUG - 2021-03-10 15:59:43,791 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:43,794 [data_handlers.py:115] : 		Grabbing surface data for sxf from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sxf_2018.h5
DEBUG - 2021-03-10 15:59:44,461 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:44,464 [data_handlers.py:115] : 		Grabbing surface data for sgp from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sgp_2018.h5
DEBUG - 2021-03-10 15:59:45,136 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:45,139 [data_handlers.py:115] : 		Grabbing surface data for srrl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/srrl_2018.h5
DEBUG - 2021-03-10 15:59:45,821 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:45,821 [data_handlers.py:83] : Loading data for site(s) [1, 2, 3, 4, 5, 6, 7, 8], from /projects/mlclouds/data_surfrad_9/2018_west_adj/mlclouds_surfrad_2018.h5
DEBUG - 2021-03-10 15:59:46,803 [data_handlers.py:101] : 	Shape temp_raw=(140160, 19), temp_all_sky=(140160, 14)
DEBUG - 2021-03-10 15:59:46,806 [data_handlers.py:104] : 	Time step is 30 minutes
DEBUG - 2021-03-10 15:59:46,806 [data_handlers.py:108] : 	Grabbing surface data for 2018 and [1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2021-03-10 15:59:46,809 [data_handlers.py:115] : 		Grabbing surface data for tbl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/tbl_2018.h5
DEBUG - 2021-03-10 15:59:47,454 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:47,458 [data_handlers.py:115] : 		Grabbing surface data for dra from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/dra_2018.h5
DEBUG - 2021-03-10 15:59:48,104 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:48,107 [data_handlers.py:115] : 		Grabbing surface data for fpk from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/fpk_2018.h5
DEBUG - 2021-03-10 15:59:48,754 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:48,757 [data_handlers.py:115] : 		Grabbing surface data for gwn from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/gwn_2018.h5
DEBUG - 2021-03-10 15:59:49,404 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:49,407 [data_handlers.py:115] : 		Grabbing surface data for psu from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/psu_2018.h5
DEBUG - 2021-03-10 15:59:50,055 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:50,058 [data_handlers.py:115] : 		Grabbing surface data for sxf from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sxf_2018.h5
DEBUG - 2021-03-10 15:59:50,705 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:50,708 [data_handlers.py:115] : 		Grabbing surface data for sgp from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sgp_2018.h5
DEBUG - 2021-03-10 15:59:51,370 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:51,373 [data_handlers.py:115] : 		Grabbing surface data for srrl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/srrl_2018.h5
DEBUG - 2021-03-10 15:59:52,024 [data_handlers.py:127] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2021-03-10 15:59:52,024 [data_handlers.py:83] : Loading data for site(s) [1, 2, 3, 4, 5, 6, 7, 8], from /projects/mlclouds/data_surfrad_9/2019_east_adj/mlclouds_surfrad_2019.h5
DEBUG - 2021-03-10 15:59:57,721 [data_handlers.py:101] : 	Shape temp_raw=(840960, 19), temp_all_sky=(840960, 14)
DEBUG - 2021-03-10 15:59:57,734 [data_handlers.py:104] : 	Time step is 5 minutes
DEBUG - 2021-03-10 15:59:57,734 [data_handlers.py:108] : 	Grabbing surface data for 2019 and [1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2021-03-10 15:59:57,737 [data_handlers.py:115] : 		Grabbing surface data for tbl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/tbl_2019.h5
DEBUG - 2021-03-10 15:59:58,461 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:58,464 [data_handlers.py:115] : 		Grabbing surface data for dra from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/dra_2019.h5
DEBUG - 2021-03-10 15:59:59,133 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:59,136 [data_handlers.py:115] : 		Grabbing surface data for fpk from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/fpk_2019.h5
DEBUG - 2021-03-10 15:59:59,810 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 15:59:59,813 [data_handlers.py:115] : 		Grabbing surface data for gwn from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/gwn_2019.h5
DEBUG - 2021-03-10 16:00:00,582 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 16:00:00,585 [data_handlers.py:115] : 		Grabbing surface data for psu from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/psu_2019.h5
DEBUG - 2021-03-10 16:00:01,271 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 16:00:01,274 [data_handlers.py:115] : 		Grabbing surface data for sxf from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sxf_2019.h5
DEBUG - 2021-03-10 16:00:01,949 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 16:00:01,952 [data_handlers.py:115] : 		Grabbing surface data for sgp from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sgp_2019.h5
DEBUG - 2021-03-10 16:00:02,643 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 16:00:02,646 [data_handlers.py:115] : 		Grabbing surface data for srrl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/srrl_2019.h5
DEBUG - 2021-03-10 16:00:03,346 [data_handlers.py:127] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2021-03-10 16:00:03,346 [data_handlers.py:83] : Loading data for site(s) [1, 2, 3, 4, 5, 6, 7, 8], from /projects/mlclouds/data_surfrad_9/2019_west_adj/mlclouds_surfrad_2019.h5
DEBUG - 2021-03-10 16:00:07,037 [data_handlers.py:101] : 	Shape temp_raw=(420480, 19), temp_all_sky=(420480, 14)
DEBUG - 2021-03-10 16:00:07,044 [data_handlers.py:104] : 	Time step is 10 minutes
DEBUG - 2021-03-10 16:00:07,044 [data_handlers.py:108] : 	Grabbing surface data for 2019 and [1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2021-03-10 16:00:07,047 [data_handlers.py:115] : 		Grabbing surface data for tbl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/tbl_2019.h5
DEBUG - 2021-03-10 16:00:07,714 [data_handlers.py:127] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2021-03-10 16:00:07,718 [data_handlers.py:115] : 		Grabbing surface data for dra from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/dra_2019.h5
DEBUG - 2021-03-10 16:00:08,376 [data_handlers.py:127] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2021-03-10 16:00:08,379 [data_handlers.py:115] : 		Grabbing surface data for fpk from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/fpk_2019.h5
DEBUG - 2021-03-10 16:00:09,048 [data_handlers.py:127] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2021-03-10 16:00:09,051 [data_handlers.py:115] : 		Grabbing surface data for gwn from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/gwn_2019.h5
DEBUG - 2021-03-10 16:00:09,710 [data_handlers.py:127] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2021-03-10 16:00:09,713 [data_handlers.py:115] : 		Grabbing surface data for psu from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/psu_2019.h5
DEBUG - 2021-03-10 16:00:10,390 [data_handlers.py:127] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2021-03-10 16:00:10,393 [data_handlers.py:115] : 		Grabbing surface data for sxf from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sxf_2019.h5
DEBUG - 2021-03-10 16:00:11,052 [data_handlers.py:127] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2021-03-10 16:00:11,055 [data_handlers.py:115] : 		Grabbing surface data for sgp from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/sgp_2019.h5
DEBUG - 2021-03-10 16:00:11,737 [data_handlers.py:127] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2021-03-10 16:00:11,741 [data_handlers.py:115] : 		Grabbing surface data for srrl from /lustre/eaglefs/projects/mlclouds/ground_measurement/surfrad/srrl_2019.h5
DEBUG - 2021-03-10 16:00:12,404 [data_handlers.py:127] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2021-03-10 16:00:12,404 [data_handlers.py:129] : Data load complete. Shape df_raw=(2803968, 19), df_all_sky=(2803968, 14), df_surf=(2803968, 5)
DEBUG - 2021-03-10 16:00:12,938 [data_handlers.py:152] : Extracting 2D arrays to run rest2 for clearsky PhyGNN inputs.
DEBUG - 2021-03-10 16:00:24,707 [data_handlers.py:169] : Running rest2 for clearsky PhyGNN inputs.
DEBUG - 2021-03-10 16:02:24,025 [data_handlers.py:187] : Completed rest2 run for clearsky PhyGNN inputs.
INFO - 2021-03-10 16:02:25,636 [data_handlers.py:60] : Prepping training data
DEBUG - 2021-03-10 16:02:25,636 [data_handlers.py:207] : Training data clean kwargs: {'filter_daylight': True, 'filter_clear': False, 'add_feature_flag': True, 'sza_lim': 89, 'nan_option': 'interp'}
DEBUG - 2021-03-10 16:02:25,636 [data_handlers.py:208] : Shape before cleaning: df_raw=(2803968, 19)
INFO - 2021-03-10 16:02:25,832 [data_cleaners.py:36] : 49.69% of timesteps are daylight
INFO - 2021-03-10 16:02:25,837 [data_cleaners.py:38] : 55.52% of daylight timesteps are cloudy
INFO - 2021-03-10 16:02:25,842 [data_cleaners.py:40] : 0.63% of daylight timesteps are missing cloud type
INFO - 2021-03-10 16:02:25,847 [data_cleaners.py:42] : 35.23% of cloudy daylight timesteps are missing cloud opd
INFO - 2021-03-10 16:02:25,851 [data_cleaners.py:44] : 35.42% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2021-03-10 16:02:25,851 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2021-03-10 16:02:25,854 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:25,858 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:25,862 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:25,865 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:25,869 [data_cleaners.py:50] : 	"refl_0_65um_nom" has 49.78% NaN values
DEBUG - 2021-03-10 16:02:25,872 [data_cleaners.py:50] : 	"refl_0_65um_nom_stddev_3x3" has 49.78% NaN values
DEBUG - 2021-03-10 16:02:25,875 [data_cleaners.py:50] : 	"refl_3_75um_nom" has 0.63% NaN values
DEBUG - 2021-03-10 16:02:25,879 [data_cleaners.py:50] : 	"temp_3_75um_nom" has 0.54% NaN values
DEBUG - 2021-03-10 16:02:25,882 [data_cleaners.py:50] : 	"temp_11_0um_nom" has 0.54% NaN values
DEBUG - 2021-03-10 16:02:25,886 [data_cleaners.py:50] : 	"temp_11_0um_nom_stddev_3x3" has 0.61% NaN values
DEBUG - 2021-03-10 16:02:25,889 [data_cleaners.py:50] : 	"cloud_probability" has 0.61% NaN values
DEBUG - 2021-03-10 16:02:25,892 [data_cleaners.py:50] : 	"cloud_fraction" has 0.61% NaN values
DEBUG - 2021-03-10 16:02:25,896 [data_cleaners.py:50] : 	"air_temperature" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:25,899 [data_cleaners.py:50] : 	"dew_point" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:25,903 [data_cleaners.py:50] : 	"relative_humidity" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:25,906 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:25,909 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:25,913 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 82.13% NaN values
DEBUG - 2021-03-10 16:02:25,916 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 82.18% NaN values
DEBUG - 2021-03-10 16:02:25,916 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2021-03-10 16:02:28,663 [data_cleaners.py:79] : Adding feature flag
INFO - 2021-03-10 16:02:29,081 [data_cleaners.py:98] : Data reduced from 2803968 rows to 1393162 after filters (49.69% of original)
DEBUG - 2021-03-10 16:02:29,179 [data_cleaners.py:104] : Feature flag column has these values: ['clear' 'bad_cloud' 'water_cloud' 'ice_cloud']
INFO - 2021-03-10 16:02:29,179 [data_cleaners.py:106] : Cleaning took 3.5 seconds
DEBUG - 2021-03-10 16:02:29,179 [data_handlers.py:211] : Shape after cleaning: df_train=(1393162, 20)
DEBUG - 2021-03-10 16:02:29,179 [data_handlers.py:214] : Cleaning df_all_sky training data (for pfun).
DEBUG - 2021-03-10 16:02:29,179 [data_handlers.py:215] : Shape before cleaning: df_all_sky=(2803968, 25)
INFO - 2021-03-10 16:02:29,450 [data_cleaners.py:36] : 49.69% of timesteps are daylight
INFO - 2021-03-10 16:02:29,455 [data_cleaners.py:38] : 55.52% of daylight timesteps are cloudy
INFO - 2021-03-10 16:02:29,459 [data_cleaners.py:40] : 0.63% of daylight timesteps are missing cloud type
INFO - 2021-03-10 16:02:29,464 [data_cleaners.py:42] : 35.23% of cloudy daylight timesteps are missing cloud opd
INFO - 2021-03-10 16:02:29,469 [data_cleaners.py:44] : 35.42% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2021-03-10 16:02:29,469 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2021-03-10 16:02:29,471 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,475 [data_cleaners.py:50] : 	"alpha" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,478 [data_cleaners.py:50] : 	"aod" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,481 [data_cleaners.py:50] : 	"asymmetry" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,485 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,488 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 82.13% NaN values
DEBUG - 2021-03-10 16:02:29,491 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 82.18% NaN values
DEBUG - 2021-03-10 16:02:29,495 [data_cleaners.py:50] : 	"ozone" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,498 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,501 [data_cleaners.py:50] : 	"ssa" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,505 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,508 [data_cleaners.py:50] : 	"surface_pressure" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,511 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,516 [data_cleaners.py:50] : 	"dhi" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,520 [data_cleaners.py:50] : 	"dni" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,524 [data_cleaners.py:50] : 	"ghi" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,527 [data_cleaners.py:50] : 	"doy" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,531 [data_cleaners.py:50] : 	"radius" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,535 [data_cleaners.py:50] : 	"Tuuclr" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,539 [data_cleaners.py:50] : 	"clearsky_ghi" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,544 [data_cleaners.py:50] : 	"clearsky_dni" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,548 [data_cleaners.py:50] : 	"Ruuclr" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,552 [data_cleaners.py:50] : 	"Tddclr" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,556 [data_cleaners.py:50] : 	"Tduclr" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,560 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2021-03-10 16:02:29,561 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2021-03-10 16:02:31,915 [data_cleaners.py:79] : Adding feature flag
INFO - 2021-03-10 16:02:32,330 [data_cleaners.py:98] : Data reduced from 2803968 rows to 1393162 after filters (49.69% of original)
DEBUG - 2021-03-10 16:02:32,449 [data_cleaners.py:104] : Feature flag column has these values: ['clear' 'bad_cloud' 'water_cloud' 'ice_cloud']
INFO - 2021-03-10 16:02:32,449 [data_cleaners.py:106] : Cleaning took 3.3 seconds
DEBUG - 2021-03-10 16:02:32,450 [data_handlers.py:219] : Shape after cleaning: df_all_sky=(1393162, 26)
DEBUG - 2021-03-10 16:02:32,527 [data_handlers.py:230] : **Shape: df_train=(1393162, 17)
DEBUG - 2021-03-10 16:02:32,550 [data_handlers.py:240] : Shapes: x=(1393162, 15), y=(1393162, 2), p=(1393162, 26)
DEBUG - 2021-03-10 16:02:32,550 [data_handlers.py:243] : Training features: ['solar_zenith_angle', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'flag']
DEBUG - 2021-03-10 16:02:32,551 [trainer.py:61] : Building PHYGNN model
INFO - 2021-03-10 16:02:32,551 [trainer.py:64] : Using p_fun: <function p_fun_all_sky at 0x2abb2e9463a0>
INFO - 2021-03-10 16:02:32,565 [trainer.py:78] : Training part A - pure data. Loss is [1, 0]
2021-03-10 16:02:41.760459: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-10 16:02:41.763376: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /nopt/slurm/current/lib:/nopt/slurm/current/lib:
2021-03-10 16:02:41.763396: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-03-10 16:02:41.763417: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (r6i0n30): /proc/driver/nvidia/version does not exist
2021-03-10 16:02:41.763722: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-10 16:02:41.765455: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
INFO - 2021-03-10 16:02:46,781 [phygnn.py:819] : Epoch 0 train loss: 5.86e-01 val loss: 5.75e-01 for "phygnn"
INFO - 2021-03-10 16:02:53,142 [phygnn.py:819] : Epoch 1 train loss: 5.13e-01 val loss: 5.00e-01 for "phygnn"
INFO - 2021-03-10 16:03:00,074 [phygnn.py:819] : Epoch 2 train loss: 4.94e-01 val loss: 4.76e-01 for "phygnn"
INFO - 2021-03-10 16:03:07,059 [phygnn.py:819] : Epoch 3 train loss: 4.84e-01 val loss: 4.71e-01 for "phygnn"
INFO - 2021-03-10 16:03:13,986 [phygnn.py:819] : Epoch 4 train loss: 4.77e-01 val loss: 4.62e-01 for "phygnn"
INFO - 2021-03-10 16:03:20,856 [phygnn.py:819] : Epoch 5 train loss: 4.78e-01 val loss: 4.58e-01 for "phygnn"
INFO - 2021-03-10 16:03:27,372 [phygnn.py:819] : Epoch 6 train loss: 4.81e-01 val loss: 4.54e-01 for "phygnn"
INFO - 2021-03-10 16:03:34,285 [phygnn.py:819] : Epoch 7 train loss: 4.65e-01 val loss: 4.52e-01 for "phygnn"
INFO - 2021-03-10 16:03:40,781 [phygnn.py:819] : Epoch 8 train loss: 4.55e-01 val loss: 4.50e-01 for "phygnn"
INFO - 2021-03-10 16:03:47,096 [phygnn.py:819] : Epoch 9 train loss: 4.66e-01 val loss: 4.45e-01 for "phygnn"
INFO - 2021-03-10 16:03:53,512 [phygnn.py:819] : Epoch 10 train loss: 4.60e-01 val loss: 4.44e-01 for "phygnn"
INFO - 2021-03-10 16:04:00,444 [phygnn.py:819] : Epoch 11 train loss: 4.53e-01 val loss: 4.38e-01 for "phygnn"
INFO - 2021-03-10 16:04:06,925 [phygnn.py:819] : Epoch 12 train loss: 4.52e-01 val loss: 4.39e-01 for "phygnn"
INFO - 2021-03-10 16:04:13,303 [phygnn.py:819] : Epoch 13 train loss: 4.49e-01 val loss: 4.34e-01 for "phygnn"
INFO - 2021-03-10 16:04:20,198 [phygnn.py:819] : Epoch 14 train loss: 4.49e-01 val loss: 4.34e-01 for "phygnn"
INFO - 2021-03-10 16:04:26,685 [phygnn.py:819] : Epoch 15 train loss: 4.45e-01 val loss: 4.32e-01 for "phygnn"
INFO - 2021-03-10 16:04:33,607 [phygnn.py:819] : Epoch 16 train loss: 4.41e-01 val loss: 4.31e-01 for "phygnn"
INFO - 2021-03-10 16:04:40,513 [phygnn.py:819] : Epoch 17 train loss: 4.54e-01 val loss: 4.31e-01 for "phygnn"
INFO - 2021-03-10 16:04:47,471 [phygnn.py:819] : Epoch 18 train loss: 4.49e-01 val loss: 4.29e-01 for "phygnn"
INFO - 2021-03-10 16:04:53,941 [phygnn.py:819] : Epoch 19 train loss: 4.49e-01 val loss: 4.26e-01 for "phygnn"
INFO - 2021-03-10 16:05:00,879 [phygnn.py:819] : Epoch 20 train loss: 4.43e-01 val loss: 4.27e-01 for "phygnn"
INFO - 2021-03-10 16:05:07,824 [phygnn.py:819] : Epoch 21 train loss: 4.43e-01 val loss: 4.27e-01 for "phygnn"
INFO - 2021-03-10 16:05:14,779 [phygnn.py:819] : Epoch 22 train loss: 4.47e-01 val loss: 4.24e-01 for "phygnn"
INFO - 2021-03-10 16:05:21,255 [phygnn.py:819] : Epoch 23 train loss: 4.33e-01 val loss: 4.22e-01 for "phygnn"
INFO - 2021-03-10 16:05:28,235 [phygnn.py:819] : Epoch 24 train loss: 4.36e-01 val loss: 4.20e-01 for "phygnn"
INFO - 2021-03-10 16:05:34,736 [phygnn.py:819] : Epoch 25 train loss: 4.39e-01 val loss: 4.18e-01 for "phygnn"
INFO - 2021-03-10 16:05:41,098 [phygnn.py:819] : Epoch 26 train loss: 4.39e-01 val loss: 4.19e-01 for "phygnn"
INFO - 2021-03-10 16:05:47,458 [phygnn.py:819] : Epoch 27 train loss: 4.33e-01 val loss: 4.16e-01 for "phygnn"
INFO - 2021-03-10 16:05:53,822 [phygnn.py:819] : Epoch 28 train loss: 4.31e-01 val loss: 4.15e-01 for "phygnn"
INFO - 2021-03-10 16:06:00,836 [phygnn.py:819] : Epoch 29 train loss: 4.23e-01 val loss: 4.14e-01 for "phygnn"
INFO - 2021-03-10 16:06:07,541 [phygnn.py:819] : Epoch 30 train loss: 4.33e-01 val loss: 4.14e-01 for "phygnn"
INFO - 2021-03-10 16:06:14,751 [phygnn.py:819] : Epoch 31 train loss: 4.25e-01 val loss: 4.13e-01 for "phygnn"
INFO - 2021-03-10 16:06:21,534 [phygnn.py:819] : Epoch 32 train loss: 4.26e-01 val loss: 4.12e-01 for "phygnn"
INFO - 2021-03-10 16:06:28,749 [phygnn.py:819] : Epoch 33 train loss: 4.23e-01 val loss: 4.10e-01 for "phygnn"
INFO - 2021-03-10 16:06:35,454 [phygnn.py:819] : Epoch 34 train loss: 4.31e-01 val loss: 4.11e-01 for "phygnn"
INFO - 2021-03-10 16:06:42,090 [phygnn.py:819] : Epoch 35 train loss: 4.37e-01 val loss: 4.09e-01 for "phygnn"
INFO - 2021-03-10 16:06:48,700 [phygnn.py:819] : Epoch 36 train loss: 4.19e-01 val loss: 4.07e-01 for "phygnn"
INFO - 2021-03-10 16:06:55,281 [phygnn.py:819] : Epoch 37 train loss: 4.16e-01 val loss: 4.08e-01 for "phygnn"
INFO - 2021-03-10 16:07:02,452 [phygnn.py:819] : Epoch 38 train loss: 4.12e-01 val loss: 4.07e-01 for "phygnn"
INFO - 2021-03-10 16:07:09,200 [phygnn.py:819] : Epoch 39 train loss: 4.20e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2021-03-10 16:07:15,774 [phygnn.py:819] : Epoch 40 train loss: 4.22e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2021-03-10 16:07:22,943 [phygnn.py:819] : Epoch 41 train loss: 4.24e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2021-03-10 16:07:29,645 [phygnn.py:819] : Epoch 42 train loss: 4.18e-01 val loss: 4.04e-01 for "phygnn"
INFO - 2021-03-10 16:07:36,843 [phygnn.py:819] : Epoch 43 train loss: 4.20e-01 val loss: 4.02e-01 for "phygnn"
INFO - 2021-03-10 16:07:44,016 [phygnn.py:819] : Epoch 44 train loss: 4.24e-01 val loss: 4.04e-01 for "phygnn"
INFO - 2021-03-10 16:07:50,742 [phygnn.py:819] : Epoch 45 train loss: 4.21e-01 val loss: 4.01e-01 for "phygnn"
INFO - 2021-03-10 16:07:58,038 [phygnn.py:819] : Epoch 46 train loss: 4.17e-01 val loss: 4.01e-01 for "phygnn"
INFO - 2021-03-10 16:08:04,947 [phygnn.py:819] : Epoch 47 train loss: 4.09e-01 val loss: 4.01e-01 for "phygnn"
INFO - 2021-03-10 16:08:11,595 [phygnn.py:819] : Epoch 48 train loss: 4.16e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2021-03-10 16:08:18,224 [phygnn.py:819] : Epoch 49 train loss: 4.24e-01 val loss: 4.02e-01 for "phygnn"
INFO - 2021-03-10 16:08:25,462 [phygnn.py:819] : Epoch 50 train loss: 4.09e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2021-03-10 16:08:32,271 [phygnn.py:819] : Epoch 51 train loss: 4.17e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2021-03-10 16:08:39,527 [phygnn.py:819] : Epoch 52 train loss: 4.18e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2021-03-10 16:08:46,338 [phygnn.py:819] : Epoch 53 train loss: 4.16e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2021-03-10 16:08:53,656 [phygnn.py:819] : Epoch 54 train loss: 4.13e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2021-03-10 16:09:00,867 [phygnn.py:819] : Epoch 55 train loss: 4.11e-01 val loss: 3.96e-01 for "phygnn"
INFO - 2021-03-10 16:09:07,745 [phygnn.py:819] : Epoch 56 train loss: 4.16e-01 val loss: 3.97e-01 for "phygnn"
INFO - 2021-03-10 16:09:14,478 [phygnn.py:819] : Epoch 57 train loss: 4.10e-01 val loss: 3.94e-01 for "phygnn"
INFO - 2021-03-10 16:09:21,146 [phygnn.py:819] : Epoch 58 train loss: 4.07e-01 val loss: 3.94e-01 for "phygnn"
INFO - 2021-03-10 16:09:27,834 [phygnn.py:819] : Epoch 59 train loss: 4.09e-01 val loss: 3.94e-01 for "phygnn"
INFO - 2021-03-10 16:09:35,106 [phygnn.py:819] : Epoch 60 train loss: 4.06e-01 val loss: 3.93e-01 for "phygnn"
INFO - 2021-03-10 16:09:42,294 [phygnn.py:819] : Epoch 61 train loss: 4.12e-01 val loss: 3.94e-01 for "phygnn"
INFO - 2021-03-10 16:09:49,076 [phygnn.py:819] : Epoch 62 train loss: 4.01e-01 val loss: 3.93e-01 for "phygnn"
INFO - 2021-03-10 16:09:56,356 [phygnn.py:819] : Epoch 63 train loss: 4.08e-01 val loss: 3.94e-01 for "phygnn"
INFO - 2021-03-10 16:10:03,610 [phygnn.py:819] : Epoch 64 train loss: 4.05e-01 val loss: 3.92e-01 for "phygnn"
INFO - 2021-03-10 16:10:10,379 [phygnn.py:819] : Epoch 65 train loss: 3.96e-01 val loss: 3.92e-01 for "phygnn"
INFO - 2021-03-10 16:10:17,621 [phygnn.py:819] : Epoch 66 train loss: 4.01e-01 val loss: 3.90e-01 for "phygnn"
INFO - 2021-03-10 16:10:24,337 [phygnn.py:819] : Epoch 67 train loss: 4.11e-01 val loss: 3.91e-01 for "phygnn"
INFO - 2021-03-10 16:10:31,624 [phygnn.py:819] : Epoch 68 train loss: 4.03e-01 val loss: 3.90e-01 for "phygnn"
INFO - 2021-03-10 16:10:38,896 [phygnn.py:819] : Epoch 69 train loss: 4.11e-01 val loss: 3.89e-01 for "phygnn"
INFO - 2021-03-10 16:10:46,133 [phygnn.py:819] : Epoch 70 train loss: 4.06e-01 val loss: 3.90e-01 for "phygnn"
INFO - 2021-03-10 16:10:52,919 [phygnn.py:819] : Epoch 71 train loss: 3.99e-01 val loss: 3.89e-01 for "phygnn"
INFO - 2021-03-10 16:11:00,268 [phygnn.py:819] : Epoch 72 train loss: 4.13e-01 val loss: 3.89e-01 for "phygnn"
INFO - 2021-03-10 16:11:07,501 [phygnn.py:819] : Epoch 73 train loss: 3.98e-01 val loss: 3.88e-01 for "phygnn"
INFO - 2021-03-10 16:11:14,286 [phygnn.py:819] : Epoch 74 train loss: 4.05e-01 val loss: 3.90e-01 for "phygnn"
INFO - 2021-03-10 16:11:21,492 [phygnn.py:819] : Epoch 75 train loss: 4.01e-01 val loss: 3.88e-01 for "phygnn"
INFO - 2021-03-10 16:11:28,323 [phygnn.py:819] : Epoch 76 train loss: 4.01e-01 val loss: 3.87e-01 for "phygnn"
INFO - 2021-03-10 16:11:35,101 [phygnn.py:819] : Epoch 77 train loss: 4.06e-01 val loss: 3.87e-01 for "phygnn"
INFO - 2021-03-10 16:11:42,316 [phygnn.py:819] : Epoch 78 train loss: 3.96e-01 val loss: 3.85e-01 for "phygnn"
INFO - 2021-03-10 16:11:49,616 [phygnn.py:819] : Epoch 79 train loss: 4.05e-01 val loss: 3.88e-01 for "phygnn"
INFO - 2021-03-10 16:11:56,803 [phygnn.py:819] : Epoch 80 train loss: 4.03e-01 val loss: 3.85e-01 for "phygnn"
INFO - 2021-03-10 16:12:04,060 [phygnn.py:819] : Epoch 81 train loss: 3.97e-01 val loss: 3.85e-01 for "phygnn"
INFO - 2021-03-10 16:12:10,865 [phygnn.py:819] : Epoch 82 train loss: 3.82e-01 val loss: 3.84e-01 for "phygnn"
INFO - 2021-03-10 16:12:18,080 [phygnn.py:819] : Epoch 83 train loss: 4.08e-01 val loss: 3.86e-01 for "phygnn"
INFO - 2021-03-10 16:12:25,348 [phygnn.py:819] : Epoch 84 train loss: 3.95e-01 val loss: 3.84e-01 for "phygnn"
INFO - 2021-03-10 16:12:32,110 [phygnn.py:819] : Epoch 85 train loss: 3.96e-01 val loss: 3.84e-01 for "phygnn"
INFO - 2021-03-10 16:12:39,337 [phygnn.py:819] : Epoch 86 train loss: 3.98e-01 val loss: 3.83e-01 for "phygnn"
INFO - 2021-03-10 16:12:46,559 [phygnn.py:819] : Epoch 87 train loss: 4.06e-01 val loss: 3.83e-01 for "phygnn"
INFO - 2021-03-10 16:12:53,391 [phygnn.py:819] : Epoch 88 train loss: 4.04e-01 val loss: 3.83e-01 for "phygnn"
INFO - 2021-03-10 16:13:00,098 [phygnn.py:819] : Epoch 89 train loss: 3.99e-01 val loss: 3.82e-01 for "phygnn"
INFO - 2021-03-10 16:13:07,325 [phygnn.py:819] : Epoch 90 train loss: 3.96e-01 val loss: 3.85e-01 for "phygnn"
INFO - 2021-03-10 16:13:14,585 [phygnn.py:819] : Epoch 91 train loss: 3.96e-01 val loss: 3.83e-01 for "phygnn"
INFO - 2021-03-10 16:13:21,305 [phygnn.py:819] : Epoch 92 train loss: 3.96e-01 val loss: 3.82e-01 for "phygnn"
INFO - 2021-03-10 16:13:28,609 [phygnn.py:819] : Epoch 93 train loss: 3.90e-01 val loss: 3.82e-01 for "phygnn"
INFO - 2021-03-10 16:13:35,805 [phygnn.py:819] : Epoch 94 train loss: 3.94e-01 val loss: 3.82e-01 for "phygnn"
INFO - 2021-03-10 16:13:43,059 [phygnn.py:819] : Epoch 95 train loss: 3.90e-01 val loss: 3.81e-01 for "phygnn"
INFO - 2021-03-10 16:13:49,881 [phygnn.py:819] : Epoch 96 train loss: 3.96e-01 val loss: 3.80e-01 for "phygnn"
INFO - 2021-03-10 16:13:57,091 [phygnn.py:819] : Epoch 97 train loss: 3.90e-01 val loss: 3.81e-01 for "phygnn"
INFO - 2021-03-10 16:14:04,285 [phygnn.py:819] : Epoch 98 train loss: 3.97e-01 val loss: 3.80e-01 for "phygnn"
INFO - 2021-03-10 16:14:11,502 [phygnn.py:819] : Epoch 99 train loss: 3.99e-01 val loss: 3.81e-01 for "phygnn"
INFO - 2021-03-10 16:14:12,615 [trainer.py:86] : Training part B - data and phygnn. Loss is [0.5, 0.5]
INFO - 2021-03-10 16:14:32,450 [phygnn.py:819] : Epoch 100 train loss: 2.72e-01 val loss: 2.60e-01 for "phygnn"
INFO - 2021-03-10 16:14:44,220 [phygnn.py:819] : Epoch 101 train loss: 2.80e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:14:55,899 [phygnn.py:819] : Epoch 102 train loss: 2.74e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:15:07,993 [phygnn.py:819] : Epoch 103 train loss: 2.74e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:15:19,388 [phygnn.py:819] : Epoch 104 train loss: 2.67e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:15:31,312 [phygnn.py:819] : Epoch 105 train loss: 2.73e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:15:43,034 [phygnn.py:819] : Epoch 106 train loss: 2.68e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:15:54,626 [phygnn.py:819] : Epoch 107 train loss: 2.69e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:16:06,805 [phygnn.py:819] : Epoch 108 train loss: 2.71e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:16:19,045 [phygnn.py:819] : Epoch 109 train loss: 2.71e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:16:30,615 [phygnn.py:819] : Epoch 110 train loss: 2.70e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:16:42,128 [phygnn.py:819] : Epoch 111 train loss: 2.73e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:16:53,781 [phygnn.py:819] : Epoch 112 train loss: 2.70e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:17:05,414 [phygnn.py:819] : Epoch 113 train loss: 2.70e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:17:17,400 [phygnn.py:819] : Epoch 114 train loss: 2.68e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:17:29,275 [phygnn.py:819] : Epoch 115 train loss: 2.71e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:17:41,461 [phygnn.py:819] : Epoch 116 train loss: 2.74e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:17:53,323 [phygnn.py:819] : Epoch 117 train loss: 2.72e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:18:05,604 [phygnn.py:819] : Epoch 118 train loss: 2.72e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:18:17,282 [phygnn.py:819] : Epoch 119 train loss: 2.72e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:18:28,752 [phygnn.py:819] : Epoch 120 train loss: 2.72e-01 val loss: 2.60e-01 for "phygnn"
INFO - 2021-03-10 16:18:40,783 [phygnn.py:819] : Epoch 121 train loss: 2.69e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:18:52,423 [phygnn.py:819] : Epoch 122 train loss: 2.70e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:19:04,501 [phygnn.py:819] : Epoch 123 train loss: 2.73e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:19:16,051 [phygnn.py:819] : Epoch 124 train loss: 2.70e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:19:27,693 [phygnn.py:819] : Epoch 125 train loss: 2.75e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:19:39,158 [phygnn.py:819] : Epoch 126 train loss: 2.72e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:19:50,721 [phygnn.py:819] : Epoch 127 train loss: 2.74e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:20:02,075 [phygnn.py:819] : Epoch 128 train loss: 2.70e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:20:14,130 [phygnn.py:819] : Epoch 129 train loss: 2.70e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:20:25,677 [phygnn.py:819] : Epoch 130 train loss: 2.64e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:20:36,960 [phygnn.py:819] : Epoch 131 train loss: 2.76e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:20:49,157 [phygnn.py:819] : Epoch 132 train loss: 2.70e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:21:00,725 [phygnn.py:819] : Epoch 133 train loss: 2.69e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:21:12,908 [phygnn.py:819] : Epoch 134 train loss: 2.70e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:21:25,104 [phygnn.py:819] : Epoch 135 train loss: 2.64e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:21:36,791 [phygnn.py:819] : Epoch 136 train loss: 2.69e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:21:48,450 [phygnn.py:819] : Epoch 137 train loss: 2.68e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:22:00,639 [phygnn.py:819] : Epoch 138 train loss: 2.67e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:22:12,379 [phygnn.py:819] : Epoch 139 train loss: 2.66e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:22:24,557 [phygnn.py:819] : Epoch 140 train loss: 2.73e-01 val loss: 2.59e-01 for "phygnn"
INFO - 2021-03-10 16:22:36,820 [phygnn.py:819] : Epoch 141 train loss: 2.71e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:22:49,059 [phygnn.py:819] : Epoch 142 train loss: 2.70e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:23:01,155 [phygnn.py:819] : Epoch 143 train loss: 2.67e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:23:13,250 [phygnn.py:819] : Epoch 144 train loss: 2.69e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:23:25,506 [phygnn.py:819] : Epoch 145 train loss: 2.66e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:23:37,542 [phygnn.py:819] : Epoch 146 train loss: 2.65e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:23:48,878 [phygnn.py:819] : Epoch 147 train loss: 2.67e-01 val loss: 2.58e-01 for "phygnn"
INFO - 2021-03-10 16:24:00,143 [phygnn.py:819] : Epoch 148 train loss: 2.73e-01 val loss: 2.58e-01 for "phygnn"
ERROR - 2021-03-10 16:24:02,974 [phygnn.py:710] : phygnn calculated a NaN loss value!
Traceback (most recent call last):
  File "k_fold.py", line 54, in <module>
    t = Trainer(train_sites=train_sites, train_files=files, config=config)
  File "/home/gbuster/code/mlclouds/mlclouds/trainer.py", line 89, in __init__
    out = model.train_model(self.x, self.y, self.p,
  File "/home/gbuster/code/phygnn/phygnn/model_interfaces/phygnn_model.py", line 177, in train_model
    diagnostics = self.model.fit(x, y, p,
  File "/home/gbuster/code/phygnn/phygnn/phygnn.py", line 813, in fit
    tr_loss, tr_nn_loss, tr_p_loss = self._run_gradient_descent(
  File "/home/gbuster/code/phygnn/phygnn/phygnn.py", line 731, in _run_gradient_descent
    grad, loss, nn_loss, p_loss = self._get_grad(x, y_true, p, p_kwargs)
  File "/home/gbuster/code/phygnn/phygnn/phygnn.py", line 722, in _get_grad
    loss, nn_loss, p_loss = self.calc_loss(y_true, y_predicted,
  File "/home/gbuster/code/phygnn/phygnn/phygnn.py", line 711, in calc_loss
    raise ArithmeticError(msg)
ArithmeticError: phygnn calculated a NaN loss value!
