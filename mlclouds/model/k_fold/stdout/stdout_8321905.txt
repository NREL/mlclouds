Starting scenario 4, validation against site 4
2022-02-14 17:07:20.469270: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /nopt/slurm/current/lib:/nopt/slurm/current/lib:
2022-02-14 17:07:20.469297: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Cross validation site: 4
Training sites: [0, 1, 2, 3, 5, 6, 7, 8]
Number of files: 8
Number of east files: 4
Number of west files: 4
Source files: ['/projects/pxs/mlclouds/training_data/2016_east_v321/mlclouds_surfrad_east_2016.h5', '/projects/pxs/mlclouds/training_data/2016_west_v321/mlclouds_surfrad_west_2016.h5', '/projects/pxs/mlclouds/training_data/2017_east_v321/mlclouds_surfrad_east_2017.h5', '/projects/pxs/mlclouds/training_data/2017_west_v321/mlclouds_surfrad_west_2017.h5', '/projects/pxs/mlclouds/training_data/2018_east_v321/mlclouds_surfrad_east_2018.h5', '/projects/pxs/mlclouds/training_data/2018_west_v321/mlclouds_surfrad_west_2018.h5', '/projects/pxs/mlclouds/training_data/2019_east_v321/mlclouds_surfrad_east_2019.h5', '/projects/pxs/mlclouds/training_data/2019_west_v321/mlclouds_surfrad_west_2019.h5']
Full config: {'clean_training_data_kwargs': {'filter_clear': False, 'nan_option': 'interp'}, 'epochs_a': 100, 'epochs_b': 100, 'features': ['solar_zenith_angle', 'cloud_type', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo'], 'hidden_layers': [{'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}], 'learning_rate': 0.0005, 'loss_weights_a': [1, 0], 'loss_weights_b': [0.5, 0.5], 'metric': 'relative_mae', 'n_batch': 32, 'one_hot_categories': {'flag': ['clear', 'ice_cloud', 'water_cloud', 'bad_cloud']}, 'p_fun': 'p_fun_all_sky', 'p_kwargs': {'loss_terms': ['mae_ghi']}, 'phygnn_seed': 0, 'surfrad_window_minutes': 15, 'y_labels': ['cld_opd_dcomp', 'cld_reff_dcomp']}
INFO - 2022-02-14 17:07:29,961 [trainer.py:40] : Trainer: Training on sites [0, 1, 2, 3, 5, 6, 7, 8] from files ['/projects/pxs/mlclouds/training_data/2016_east_v321/mlclouds_surfrad_east_2016.h5', '/projects/pxs/mlclouds/training_data/2016_west_v321/mlclouds_surfrad_west_2016.h5', '/projects/pxs/mlclouds/training_data/2017_east_v321/mlclouds_surfrad_east_2017.h5', '/projects/pxs/mlclouds/training_data/2017_west_v321/mlclouds_surfrad_west_2017.h5', '/projects/pxs/mlclouds/training_data/2018_east_v321/mlclouds_surfrad_east_2018.h5', '/projects/pxs/mlclouds/training_data/2018_west_v321/mlclouds_surfrad_west_2018.h5', '/projects/pxs/mlclouds/training_data/2019_east_v321/mlclouds_surfrad_east_2019.h5', '/projects/pxs/mlclouds/training_data/2019_west_v321/mlclouds_surfrad_west_2019.h5']
INFO - 2022-02-14 17:07:29,961 [trainer.py:49] : Trainer: Training on sites [0, 1, 2, 3, 5, 6, 7, 8] from files ['/projects/pxs/mlclouds/training_data/2016_east_v321/mlclouds_surfrad_east_2016.h5', '/projects/pxs/mlclouds/training_data/2016_west_v321/mlclouds_surfrad_west_2016.h5', '/projects/pxs/mlclouds/training_data/2017_east_v321/mlclouds_surfrad_east_2017.h5', '/projects/pxs/mlclouds/training_data/2017_west_v321/mlclouds_surfrad_west_2017.h5', '/projects/pxs/mlclouds/training_data/2018_east_v321/mlclouds_surfrad_east_2018.h5', '/projects/pxs/mlclouds/training_data/2018_west_v321/mlclouds_surfrad_west_2018.h5', '/projects/pxs/mlclouds/training_data/2019_east_v321/mlclouds_surfrad_east_2019.h5', '/projects/pxs/mlclouds/training_data/2019_west_v321/mlclouds_surfrad_west_2019.h5']
INFO - 2022-02-14 17:07:29,961 [data_handlers.py:60] : Loading training data
DEBUG - 2022-02-14 17:07:29,961 [data_handlers.py:78] : Loading vars ['solar_zenith_angle', 'cloud_type', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'cld_opd_dcomp', 'cld_reff_dcomp']
DEBUG - 2022-02-14 17:07:29,961 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2016_east_v321/mlclouds_surfrad_east_2016.h5
DEBUG - 2022-02-14 17:07:31,167 [data_handlers.py:103] : 	Shape temp_raw=(140544, 19), temp_all_sky=(140544, 14)
DEBUG - 2022-02-14 17:07:31,170 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2022-02-14 17:07:31,171 [data_handlers.py:110] : 	Grabbing surface data for 2016 and [0, 1, 2, 3, 5, 6, 7, 8]
DEBUG - 2022-02-14 17:07:31,175 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2016.h5
DEBUG - 2022-02-14 17:07:31,890 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:31,893 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2016.h5
DEBUG - 2022-02-14 17:07:32,542 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:32,546 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2016.h5
DEBUG - 2022-02-14 17:07:33,198 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:33,201 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2016.h5
DEBUG - 2022-02-14 17:07:33,866 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:33,869 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2016.h5
DEBUG - 2022-02-14 17:07:34,667 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:34,671 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2016.h5
DEBUG - 2022-02-14 17:07:35,391 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:35,395 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2016.h5
DEBUG - 2022-02-14 17:07:36,105 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:36,109 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2016.h5
DEBUG - 2022-02-14 17:07:36,856 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:36,856 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2016_west_v321/mlclouds_surfrad_west_2016.h5
DEBUG - 2022-02-14 17:07:37,869 [data_handlers.py:103] : 	Shape temp_raw=(140544, 19), temp_all_sky=(140544, 14)
DEBUG - 2022-02-14 17:07:37,873 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2022-02-14 17:07:37,873 [data_handlers.py:110] : 	Grabbing surface data for 2016 and [0, 1, 2, 3, 5, 6, 7, 8]
DEBUG - 2022-02-14 17:07:37,876 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2016.h5
DEBUG - 2022-02-14 17:07:38,512 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:38,515 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2016.h5
DEBUG - 2022-02-14 17:07:39,140 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:39,144 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2016.h5
DEBUG - 2022-02-14 17:07:39,770 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:39,773 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2016.h5
DEBUG - 2022-02-14 17:07:40,408 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:40,411 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2016.h5
DEBUG - 2022-02-14 17:07:41,039 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:41,042 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2016.h5
DEBUG - 2022-02-14 17:07:41,663 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:41,667 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2016.h5
DEBUG - 2022-02-14 17:07:42,308 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:42,311 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2016.h5
DEBUG - 2022-02-14 17:07:42,944 [data_handlers.py:134] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2022-02-14 17:07:42,944 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2017_east_v321/mlclouds_surfrad_east_2017.h5
DEBUG - 2022-02-14 17:07:43,921 [data_handlers.py:103] : 	Shape temp_raw=(140160, 19), temp_all_sky=(140160, 14)
DEBUG - 2022-02-14 17:07:43,925 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2022-02-14 17:07:43,925 [data_handlers.py:110] : 	Grabbing surface data for 2017 and [0, 1, 2, 3, 5, 6, 7, 8]
DEBUG - 2022-02-14 17:07:43,929 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2017.h5
DEBUG - 2022-02-14 17:07:44,589 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:44,592 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2017.h5
DEBUG - 2022-02-14 17:07:45,232 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:45,235 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2017.h5
DEBUG - 2022-02-14 17:07:45,872 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:45,876 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2017.h5
DEBUG - 2022-02-14 17:07:46,515 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:46,519 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2017.h5
DEBUG - 2022-02-14 17:07:47,210 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:47,213 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2017.h5
DEBUG - 2022-02-14 17:07:47,891 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:47,894 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2017.h5
DEBUG - 2022-02-14 17:07:48,560 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:48,564 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2017.h5
DEBUG - 2022-02-14 17:07:49,283 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:49,283 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2017_west_v321/mlclouds_surfrad_west_2017.h5
DEBUG - 2022-02-14 17:07:50,289 [data_handlers.py:103] : 	Shape temp_raw=(140160, 19), temp_all_sky=(140160, 14)
DEBUG - 2022-02-14 17:07:50,293 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2022-02-14 17:07:50,293 [data_handlers.py:110] : 	Grabbing surface data for 2017 and [0, 1, 2, 3, 5, 6, 7, 8]
DEBUG - 2022-02-14 17:07:50,296 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2017.h5
DEBUG - 2022-02-14 17:07:50,925 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:50,928 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2017.h5
DEBUG - 2022-02-14 17:07:51,550 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:51,553 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2017.h5
DEBUG - 2022-02-14 17:07:52,174 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:52,178 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2017.h5
DEBUG - 2022-02-14 17:07:52,796 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:52,799 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2017.h5
DEBUG - 2022-02-14 17:07:53,425 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:53,428 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2017.h5
DEBUG - 2022-02-14 17:07:54,043 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:54,046 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2017.h5
DEBUG - 2022-02-14 17:07:54,671 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:54,674 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2017.h5
DEBUG - 2022-02-14 17:07:55,296 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:07:55,296 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2018_east_v321/mlclouds_surfrad_east_2018.h5
DEBUG - 2022-02-14 17:08:01,021 [data_handlers.py:103] : 	Shape temp_raw=(840960, 19), temp_all_sky=(840960, 14)
DEBUG - 2022-02-14 17:08:01,038 [data_handlers.py:106] : 	Time step is 5 minutes
DEBUG - 2022-02-14 17:08:01,038 [data_handlers.py:110] : 	Grabbing surface data for 2018 and [0, 1, 2, 3, 5, 6, 7, 8]
DEBUG - 2022-02-14 17:08:01,042 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2018.h5
DEBUG - 2022-02-14 17:08:01,678 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:01,681 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2018.h5
DEBUG - 2022-02-14 17:08:02,321 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:02,324 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2018.h5
DEBUG - 2022-02-14 17:08:02,962 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:02,965 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2018.h5
DEBUG - 2022-02-14 17:08:03,608 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:03,611 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2018.h5
DEBUG - 2022-02-14 17:08:04,269 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:04,272 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2018.h5
DEBUG - 2022-02-14 17:08:04,926 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:04,929 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2018.h5
DEBUG - 2022-02-14 17:08:05,611 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:05,614 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2018.h5
DEBUG - 2022-02-14 17:08:06,333 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:06,333 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2018_west_v321/mlclouds_surfrad_west_2018.h5
DEBUG - 2022-02-14 17:08:07,522 [data_handlers.py:103] : 	Shape temp_raw=(140160, 19), temp_all_sky=(140160, 14)
DEBUG - 2022-02-14 17:08:07,526 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2022-02-14 17:08:07,526 [data_handlers.py:110] : 	Grabbing surface data for 2018 and [0, 1, 2, 3, 5, 6, 7, 8]
DEBUG - 2022-02-14 17:08:07,529 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2018.h5
DEBUG - 2022-02-14 17:08:08,147 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:08:08,150 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2018.h5
DEBUG - 2022-02-14 17:08:08,781 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:08:08,785 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2018.h5
DEBUG - 2022-02-14 17:08:09,405 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:08:09,408 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2018.h5
DEBUG - 2022-02-14 17:08:10,039 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:08:10,042 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2018.h5
DEBUG - 2022-02-14 17:08:10,663 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:08:10,666 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2018.h5
DEBUG - 2022-02-14 17:08:11,296 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:08:11,299 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2018.h5
DEBUG - 2022-02-14 17:08:11,925 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:08:11,928 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2018.h5
DEBUG - 2022-02-14 17:08:12,559 [data_handlers.py:134] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2022-02-14 17:08:12,559 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2019_east_v321/mlclouds_surfrad_east_2019.h5
DEBUG - 2022-02-14 17:08:18,291 [data_handlers.py:103] : 	Shape temp_raw=(840960, 19), temp_all_sky=(840960, 14)
DEBUG - 2022-02-14 17:08:18,309 [data_handlers.py:106] : 	Time step is 5 minutes
DEBUG - 2022-02-14 17:08:18,309 [data_handlers.py:110] : 	Grabbing surface data for 2019 and [0, 1, 2, 3, 5, 6, 7, 8]
DEBUG - 2022-02-14 17:08:18,312 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2019.h5
DEBUG - 2022-02-14 17:08:19,000 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:19,003 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2019.h5
DEBUG - 2022-02-14 17:08:19,648 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:19,651 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2019.h5
DEBUG - 2022-02-14 17:08:20,309 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:20,312 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2019.h5
DEBUG - 2022-02-14 17:08:20,964 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:20,968 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2019.h5
DEBUG - 2022-02-14 17:08:21,658 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:21,661 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2019.h5
DEBUG - 2022-02-14 17:08:22,341 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:22,345 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2019.h5
DEBUG - 2022-02-14 17:08:23,029 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:23,032 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2019.h5
DEBUG - 2022-02-14 17:08:23,782 [data_handlers.py:134] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2022-02-14 17:08:23,782 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2019_west_v321/mlclouds_surfrad_west_2019.h5
DEBUG - 2022-02-14 17:08:26,737 [data_handlers.py:103] : 	Shape temp_raw=(420480, 19), temp_all_sky=(420480, 14)
DEBUG - 2022-02-14 17:08:26,746 [data_handlers.py:106] : 	Time step is 10 minutes
DEBUG - 2022-02-14 17:08:26,746 [data_handlers.py:110] : 	Grabbing surface data for 2019 and [0, 1, 2, 3, 5, 6, 7, 8]
DEBUG - 2022-02-14 17:08:26,749 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2019.h5
DEBUG - 2022-02-14 17:08:27,387 [data_handlers.py:134] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2022-02-14 17:08:27,391 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2019.h5
DEBUG - 2022-02-14 17:08:28,033 [data_handlers.py:134] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2022-02-14 17:08:28,037 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2019.h5
DEBUG - 2022-02-14 17:08:28,677 [data_handlers.py:134] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2022-02-14 17:08:28,680 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2019.h5
DEBUG - 2022-02-14 17:08:29,322 [data_handlers.py:134] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2022-02-14 17:08:29,326 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2019.h5
DEBUG - 2022-02-14 17:08:29,965 [data_handlers.py:134] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2022-02-14 17:08:29,969 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2019.h5
DEBUG - 2022-02-14 17:08:30,609 [data_handlers.py:134] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2022-02-14 17:08:30,612 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2019.h5
DEBUG - 2022-02-14 17:08:31,260 [data_handlers.py:134] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2022-02-14 17:08:31,264 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2019.h5
DEBUG - 2022-02-14 17:08:31,914 [data_handlers.py:134] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2022-02-14 17:08:31,915 [data_handlers.py:136] : Data load complete. Shape df_raw=(2803968, 19), df_all_sky=(2803968, 14), df_surf=(2803968, 5)
DEBUG - 2022-02-14 17:08:32,731 [data_handlers.py:159] : Extracting 2D arrays to run rest2 for clearsky PhyGNN inputs.
DEBUG - 2022-02-14 17:08:44,376 [data_handlers.py:176] : Running rest2 for clearsky PhyGNN inputs.
DEBUG - 2022-02-14 17:10:32,268 [data_handlers.py:194] : Completed rest2 run for clearsky PhyGNN inputs.
INFO - 2022-02-14 17:10:33,675 [data_handlers.py:62] : Prepping training data
DEBUG - 2022-02-14 17:10:33,675 [data_handlers.py:214] : Training data clean kwargs: {'filter_daylight': True, 'filter_clear': False, 'add_feature_flag': True, 'sza_lim': 89, 'nan_option': 'interp'}
DEBUG - 2022-02-14 17:10:33,675 [data_handlers.py:215] : Shape before cleaning: df_raw=(2803968, 19)
INFO - 2022-02-14 17:10:33,924 [data_cleaners.py:36] : 49.68% of timesteps are daylight
INFO - 2022-02-14 17:10:33,929 [data_cleaners.py:38] : 54.57% of daylight timesteps are cloudy
INFO - 2022-02-14 17:10:33,934 [data_cleaners.py:40] : 2.05% of daylight timesteps are missing cloud type
INFO - 2022-02-14 17:10:33,938 [data_cleaners.py:42] : 33.70% of cloudy daylight timesteps are missing cloud opd
INFO - 2022-02-14 17:10:33,943 [data_cleaners.py:44] : 33.90% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2022-02-14 17:10:33,943 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2022-02-14 17:10:33,946 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:33,950 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:33,954 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:33,958 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:33,962 [data_cleaners.py:50] : 	"refl_0_65um_nom" has 50.53% NaN values
DEBUG - 2022-02-14 17:10:33,965 [data_cleaners.py:50] : 	"refl_0_65um_nom_stddev_3x3" has 50.53% NaN values
DEBUG - 2022-02-14 17:10:33,968 [data_cleaners.py:50] : 	"refl_3_75um_nom" has 2.09% NaN values
DEBUG - 2022-02-14 17:10:33,972 [data_cleaners.py:50] : 	"temp_3_75um_nom" has 1.99% NaN values
DEBUG - 2022-02-14 17:10:33,975 [data_cleaners.py:50] : 	"temp_11_0um_nom" has 1.99% NaN values
DEBUG - 2022-02-14 17:10:33,979 [data_cleaners.py:50] : 	"temp_11_0um_nom_stddev_3x3" has 2.07% NaN values
DEBUG - 2022-02-14 17:10:33,982 [data_cleaners.py:50] : 	"cloud_probability" has 2.07% NaN values
DEBUG - 2022-02-14 17:10:33,986 [data_cleaners.py:50] : 	"cloud_fraction" has 2.07% NaN values
DEBUG - 2022-02-14 17:10:33,989 [data_cleaners.py:50] : 	"air_temperature" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:33,993 [data_cleaners.py:50] : 	"dew_point" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:33,996 [data_cleaners.py:50] : 	"relative_humidity" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:34,000 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:34,003 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:34,007 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 82.02% NaN values
DEBUG - 2022-02-14 17:10:34,010 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 82.08% NaN values
DEBUG - 2022-02-14 17:10:34,010 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2022-02-14 17:10:36,638 [data_cleaners.py:79] : Adding feature flag
INFO - 2022-02-14 17:10:36,866 [data_cleaners.py:98] : Data reduced from 2803968 rows to 1393069 after filters (49.68% of original)
DEBUG - 2022-02-14 17:10:36,972 [data_cleaners.py:104] : Feature flag column has these values: ['clear' 'bad_cloud' 'water_cloud' 'ice_cloud']
INFO - 2022-02-14 17:10:36,972 [data_cleaners.py:106] : Cleaning took 3.3 seconds
DEBUG - 2022-02-14 17:10:36,973 [data_handlers.py:218] : Shape after cleaning: df_train=(1393069, 20)
DEBUG - 2022-02-14 17:10:36,973 [data_handlers.py:221] : Cleaning df_all_sky training data (for pfun).
DEBUG - 2022-02-14 17:10:36,973 [data_handlers.py:222] : Shape before cleaning: df_all_sky=(2803968, 25)
INFO - 2022-02-14 17:10:37,261 [data_cleaners.py:36] : 49.68% of timesteps are daylight
INFO - 2022-02-14 17:10:37,266 [data_cleaners.py:38] : 54.57% of daylight timesteps are cloudy
INFO - 2022-02-14 17:10:37,271 [data_cleaners.py:40] : 2.05% of daylight timesteps are missing cloud type
INFO - 2022-02-14 17:10:37,275 [data_cleaners.py:42] : 33.70% of cloudy daylight timesteps are missing cloud opd
INFO - 2022-02-14 17:10:37,280 [data_cleaners.py:44] : 33.90% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2022-02-14 17:10:37,280 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2022-02-14 17:10:37,283 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,286 [data_cleaners.py:50] : 	"alpha" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,290 [data_cleaners.py:50] : 	"aod" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,293 [data_cleaners.py:50] : 	"asymmetry" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,298 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,301 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 82.02% NaN values
DEBUG - 2022-02-14 17:10:37,304 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 82.08% NaN values
DEBUG - 2022-02-14 17:10:37,308 [data_cleaners.py:50] : 	"ozone" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,311 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,315 [data_cleaners.py:50] : 	"ssa" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,318 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,321 [data_cleaners.py:50] : 	"surface_pressure" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,324 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,329 [data_cleaners.py:50] : 	"surfrad_dhi" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,333 [data_cleaners.py:50] : 	"surfrad_dni" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,337 [data_cleaners.py:50] : 	"surfrad_ghi" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,340 [data_cleaners.py:50] : 	"doy" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,344 [data_cleaners.py:50] : 	"radius" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,349 [data_cleaners.py:50] : 	"Tuuclr" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,353 [data_cleaners.py:50] : 	"clearsky_ghi" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,357 [data_cleaners.py:50] : 	"clearsky_dni" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,362 [data_cleaners.py:50] : 	"Ruuclr" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,366 [data_cleaners.py:50] : 	"Tddclr" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,370 [data_cleaners.py:50] : 	"Tduclr" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,375 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2022-02-14 17:10:37,375 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2022-02-14 17:10:39,572 [data_cleaners.py:79] : Adding feature flag
INFO - 2022-02-14 17:10:39,798 [data_cleaners.py:98] : Data reduced from 2803968 rows to 1393069 after filters (49.68% of original)
DEBUG - 2022-02-14 17:10:39,929 [data_cleaners.py:104] : Feature flag column has these values: ['clear' 'bad_cloud' 'water_cloud' 'ice_cloud']
INFO - 2022-02-14 17:10:39,929 [data_cleaners.py:106] : Cleaning took 3.0 seconds
DEBUG - 2022-02-14 17:10:39,930 [data_handlers.py:226] : Shape after cleaning: df_all_sky=(1393069, 26)
DEBUG - 2022-02-14 17:10:40,008 [data_handlers.py:237] : **Shape: df_train=(1393069, 17)
DEBUG - 2022-02-14 17:10:40,031 [data_handlers.py:247] : Shapes: x=(1393069, 15), y=(1393069, 2), p=(1393069, 26)
DEBUG - 2022-02-14 17:10:40,031 [data_handlers.py:250] : Training features: ['solar_zenith_angle', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'flag']
DEBUG - 2022-02-14 17:10:40,031 [trainer.py:67] : Building PHYGNN model
INFO - 2022-02-14 17:10:40,031 [trainer.py:70] : Using p_fun: <function p_fun_all_sky at 0x2b208d40c670>
INFO - 2022-02-14 17:10:40,032 [base.py:152] : Active python environment versions: 
{   'numpy': '1.22.2',
    'pandas': '1.2.4',
    'phygnn': '0.0.14',
    'python': '3.8.8 (default, Feb 24 2021, 21:46:12) \n[GCC 7.3.0]',
    'sklearn': '0.24.1',
    'tensorflow': '2.8.0'}
INFO - 2022-02-14 17:10:40,047 [base.py:111] : Successfully initialized model with 17 layers
INFO - 2022-02-14 17:10:40,048 [trainer.py:84] : Training part A - pure data. Loss is [1, 0]
2022-02-14 17:10:48.010533: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /nopt/slurm/current/lib:/nopt/slurm/current/lib:
2022-02-14 17:10:48.010567: W tensorflow/stream_executor/cuda/cuda_driver.cc:269] failed call to cuInit: UNKNOWN ERROR (303)
2022-02-14 17:10:48.010586: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (r9i3n13): /proc/driver/nvidia/version does not exist
2022-02-14 17:10:48.010917: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
INFO - 2022-02-14 17:10:56,123 [phygnn.py:576] : Epoch 0 train loss: 6.80e-01 val loss: 6.68e-01 for "phygnn"
INFO - 2022-02-14 17:11:04,266 [phygnn.py:576] : Epoch 1 train loss: 6.22e-01 val loss: 6.08e-01 for "phygnn"
INFO - 2022-02-14 17:11:12,407 [phygnn.py:576] : Epoch 2 train loss: 5.49e-01 val loss: 5.36e-01 for "phygnn"
INFO - 2022-02-14 17:11:20,828 [phygnn.py:576] : Epoch 3 train loss: 5.18e-01 val loss: 4.97e-01 for "phygnn"
INFO - 2022-02-14 17:11:28,856 [phygnn.py:576] : Epoch 4 train loss: 4.96e-01 val loss: 4.74e-01 for "phygnn"
INFO - 2022-02-14 17:11:37,519 [phygnn.py:576] : Epoch 5 train loss: 4.82e-01 val loss: 4.62e-01 for "phygnn"
INFO - 2022-02-14 17:11:45,804 [phygnn.py:576] : Epoch 6 train loss: 4.79e-01 val loss: 4.55e-01 for "phygnn"
INFO - 2022-02-14 17:11:54,121 [phygnn.py:576] : Epoch 7 train loss: 4.68e-01 val loss: 4.51e-01 for "phygnn"
INFO - 2022-02-14 17:12:02,552 [phygnn.py:576] : Epoch 8 train loss: 4.68e-01 val loss: 4.48e-01 for "phygnn"
INFO - 2022-02-14 17:12:11,170 [phygnn.py:576] : Epoch 9 train loss: 4.65e-01 val loss: 4.46e-01 for "phygnn"
INFO - 2022-02-14 17:12:19,503 [phygnn.py:576] : Epoch 10 train loss: 4.56e-01 val loss: 4.42e-01 for "phygnn"
INFO - 2022-02-14 17:12:27,772 [phygnn.py:576] : Epoch 11 train loss: 4.59e-01 val loss: 4.41e-01 for "phygnn"
INFO - 2022-02-14 17:12:36,132 [phygnn.py:576] : Epoch 12 train loss: 4.52e-01 val loss: 4.38e-01 for "phygnn"
INFO - 2022-02-14 17:12:44,800 [phygnn.py:576] : Epoch 13 train loss: 4.52e-01 val loss: 4.37e-01 for "phygnn"
INFO - 2022-02-14 17:12:53,448 [phygnn.py:576] : Epoch 14 train loss: 4.51e-01 val loss: 4.36e-01 for "phygnn"
INFO - 2022-02-14 17:13:01,880 [phygnn.py:576] : Epoch 15 train loss: 4.41e-01 val loss: 4.32e-01 for "phygnn"
INFO - 2022-02-14 17:13:10,391 [phygnn.py:576] : Epoch 16 train loss: 4.48e-01 val loss: 4.32e-01 for "phygnn"
INFO - 2022-02-14 17:13:18,449 [phygnn.py:576] : Epoch 17 train loss: 4.49e-01 val loss: 4.32e-01 for "phygnn"
INFO - 2022-02-14 17:13:26,371 [phygnn.py:576] : Epoch 18 train loss: 4.39e-01 val loss: 4.30e-01 for "phygnn"
INFO - 2022-02-14 17:13:34,392 [phygnn.py:576] : Epoch 19 train loss: 4.39e-01 val loss: 4.27e-01 for "phygnn"
INFO - 2022-02-14 17:13:42,461 [phygnn.py:576] : Epoch 20 train loss: 4.46e-01 val loss: 4.27e-01 for "phygnn"
INFO - 2022-02-14 17:13:50,709 [phygnn.py:576] : Epoch 21 train loss: 4.38e-01 val loss: 4.25e-01 for "phygnn"
INFO - 2022-02-14 17:13:59,149 [phygnn.py:576] : Epoch 22 train loss: 4.38e-01 val loss: 4.25e-01 for "phygnn"
INFO - 2022-02-14 17:14:07,395 [phygnn.py:576] : Epoch 23 train loss: 4.39e-01 val loss: 4.25e-01 for "phygnn"
INFO - 2022-02-14 17:14:15,790 [phygnn.py:576] : Epoch 24 train loss: 4.34e-01 val loss: 4.23e-01 for "phygnn"
INFO - 2022-02-14 17:14:24,422 [phygnn.py:576] : Epoch 25 train loss: 4.39e-01 val loss: 4.21e-01 for "phygnn"
INFO - 2022-02-14 17:14:32,995 [phygnn.py:576] : Epoch 26 train loss: 4.34e-01 val loss: 4.21e-01 for "phygnn"
INFO - 2022-02-14 17:14:41,195 [phygnn.py:576] : Epoch 27 train loss: 4.32e-01 val loss: 4.20e-01 for "phygnn"
INFO - 2022-02-14 17:14:49,158 [phygnn.py:576] : Epoch 28 train loss: 4.35e-01 val loss: 4.21e-01 for "phygnn"
INFO - 2022-02-14 17:14:57,436 [phygnn.py:576] : Epoch 29 train loss: 4.35e-01 val loss: 4.18e-01 for "phygnn"
INFO - 2022-02-14 17:15:05,420 [phygnn.py:576] : Epoch 30 train loss: 4.34e-01 val loss: 4.19e-01 for "phygnn"
INFO - 2022-02-14 17:15:14,108 [phygnn.py:576] : Epoch 31 train loss: 4.37e-01 val loss: 4.19e-01 for "phygnn"
INFO - 2022-02-14 17:15:22,777 [phygnn.py:576] : Epoch 32 train loss: 4.29e-01 val loss: 4.16e-01 for "phygnn"
INFO - 2022-02-14 17:15:31,017 [phygnn.py:576] : Epoch 33 train loss: 4.31e-01 val loss: 4.16e-01 for "phygnn"
INFO - 2022-02-14 17:15:38,794 [phygnn.py:576] : Epoch 34 train loss: 4.28e-01 val loss: 4.15e-01 for "phygnn"
INFO - 2022-02-14 17:15:47,040 [phygnn.py:576] : Epoch 35 train loss: 4.31e-01 val loss: 4.14e-01 for "phygnn"
INFO - 2022-02-14 17:15:55,176 [phygnn.py:576] : Epoch 36 train loss: 4.31e-01 val loss: 4.15e-01 for "phygnn"
INFO - 2022-02-14 17:16:03,173 [phygnn.py:576] : Epoch 37 train loss: 4.28e-01 val loss: 4.14e-01 for "phygnn"
INFO - 2022-02-14 17:16:11,527 [phygnn.py:576] : Epoch 38 train loss: 4.28e-01 val loss: 4.13e-01 for "phygnn"
INFO - 2022-02-14 17:16:19,819 [phygnn.py:576] : Epoch 39 train loss: 4.17e-01 val loss: 4.13e-01 for "phygnn"
INFO - 2022-02-14 17:16:28,404 [phygnn.py:576] : Epoch 40 train loss: 4.26e-01 val loss: 4.12e-01 for "phygnn"
INFO - 2022-02-14 17:16:36,719 [phygnn.py:576] : Epoch 41 train loss: 4.27e-01 val loss: 4.12e-01 for "phygnn"
INFO - 2022-02-14 17:16:44,559 [phygnn.py:576] : Epoch 42 train loss: 4.22e-01 val loss: 4.11e-01 for "phygnn"
INFO - 2022-02-14 17:16:52,666 [phygnn.py:576] : Epoch 43 train loss: 4.22e-01 val loss: 4.10e-01 for "phygnn"
INFO - 2022-02-14 17:17:00,957 [phygnn.py:576] : Epoch 44 train loss: 4.20e-01 val loss: 4.10e-01 for "phygnn"
INFO - 2022-02-14 17:17:09,564 [phygnn.py:576] : Epoch 45 train loss: 4.20e-01 val loss: 4.09e-01 for "phygnn"
INFO - 2022-02-14 17:17:18,198 [phygnn.py:576] : Epoch 46 train loss: 4.17e-01 val loss: 4.09e-01 for "phygnn"
INFO - 2022-02-14 17:17:26,360 [phygnn.py:576] : Epoch 47 train loss: 4.28e-01 val loss: 4.09e-01 for "phygnn"
INFO - 2022-02-14 17:17:34,760 [phygnn.py:576] : Epoch 48 train loss: 4.21e-01 val loss: 4.09e-01 for "phygnn"
INFO - 2022-02-14 17:17:42,858 [phygnn.py:576] : Epoch 49 train loss: 4.14e-01 val loss: 4.08e-01 for "phygnn"
INFO - 2022-02-14 17:17:51,510 [phygnn.py:576] : Epoch 50 train loss: 4.23e-01 val loss: 4.07e-01 for "phygnn"
INFO - 2022-02-14 17:17:59,859 [phygnn.py:576] : Epoch 51 train loss: 4.19e-01 val loss: 4.07e-01 for "phygnn"
INFO - 2022-02-14 17:18:07,926 [phygnn.py:576] : Epoch 52 train loss: 4.16e-01 val loss: 4.06e-01 for "phygnn"
INFO - 2022-02-14 17:18:16,135 [phygnn.py:576] : Epoch 53 train loss: 4.21e-01 val loss: 4.07e-01 for "phygnn"
INFO - 2022-02-14 17:18:24,361 [phygnn.py:576] : Epoch 54 train loss: 4.11e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2022-02-14 17:18:32,527 [phygnn.py:576] : Epoch 55 train loss: 4.15e-01 val loss: 4.06e-01 for "phygnn"
INFO - 2022-02-14 17:18:40,348 [phygnn.py:576] : Epoch 56 train loss: 4.22e-01 val loss: 4.06e-01 for "phygnn"
INFO - 2022-02-14 17:18:48,286 [phygnn.py:576] : Epoch 57 train loss: 4.18e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2022-02-14 17:18:56,702 [phygnn.py:576] : Epoch 58 train loss: 4.16e-01 val loss: 4.04e-01 for "phygnn"
INFO - 2022-02-14 17:19:05,024 [phygnn.py:576] : Epoch 59 train loss: 4.16e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2022-02-14 17:19:13,070 [phygnn.py:576] : Epoch 60 train loss: 4.12e-01 val loss: 4.03e-01 for "phygnn"
INFO - 2022-02-14 17:19:21,518 [phygnn.py:576] : Epoch 61 train loss: 4.24e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2022-02-14 17:19:30,136 [phygnn.py:576] : Epoch 62 train loss: 4.19e-01 val loss: 4.03e-01 for "phygnn"
INFO - 2022-02-14 17:19:38,592 [phygnn.py:576] : Epoch 63 train loss: 4.19e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2022-02-14 17:19:46,864 [phygnn.py:576] : Epoch 64 train loss: 4.13e-01 val loss: 4.03e-01 for "phygnn"
INFO - 2022-02-14 17:19:55,083 [phygnn.py:576] : Epoch 65 train loss: 4.14e-01 val loss: 4.03e-01 for "phygnn"
INFO - 2022-02-14 17:20:03,729 [phygnn.py:576] : Epoch 66 train loss: 4.14e-01 val loss: 4.03e-01 for "phygnn"
INFO - 2022-02-14 17:20:12,010 [phygnn.py:576] : Epoch 67 train loss: 4.07e-01 val loss: 4.03e-01 for "phygnn"
INFO - 2022-02-14 17:20:20,115 [phygnn.py:576] : Epoch 68 train loss: 4.14e-01 val loss: 4.03e-01 for "phygnn"
INFO - 2022-02-14 17:20:28,737 [phygnn.py:576] : Epoch 69 train loss: 4.07e-01 val loss: 4.02e-01 for "phygnn"
INFO - 2022-02-14 17:20:37,097 [phygnn.py:576] : Epoch 70 train loss: 4.15e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2022-02-14 17:20:45,740 [phygnn.py:576] : Epoch 71 train loss: 4.16e-01 val loss: 4.02e-01 for "phygnn"
INFO - 2022-02-14 17:20:54,377 [phygnn.py:576] : Epoch 72 train loss: 4.19e-01 val loss: 4.01e-01 for "phygnn"
INFO - 2022-02-14 17:21:02,892 [phygnn.py:576] : Epoch 73 train loss: 4.17e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2022-02-14 17:21:11,108 [phygnn.py:576] : Epoch 74 train loss: 4.09e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2022-02-14 17:21:19,428 [phygnn.py:576] : Epoch 75 train loss: 4.15e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2022-02-14 17:21:27,766 [phygnn.py:576] : Epoch 76 train loss: 4.09e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2022-02-14 17:21:35,576 [phygnn.py:576] : Epoch 77 train loss: 4.07e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2022-02-14 17:21:43,534 [phygnn.py:576] : Epoch 78 train loss: 4.08e-01 val loss: 3.99e-01 for "phygnn"
INFO - 2022-02-14 17:21:52,085 [phygnn.py:576] : Epoch 79 train loss: 4.07e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2022-02-14 17:22:00,621 [phygnn.py:576] : Epoch 80 train loss: 4.16e-01 val loss: 4.01e-01 for "phygnn"
INFO - 2022-02-14 17:22:08,784 [phygnn.py:576] : Epoch 81 train loss: 4.11e-01 val loss: 3.97e-01 for "phygnn"
INFO - 2022-02-14 17:22:17,281 [phygnn.py:576] : Epoch 82 train loss: 4.05e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2022-02-14 17:22:25,175 [phygnn.py:576] : Epoch 83 train loss: 4.06e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2022-02-14 17:22:33,791 [phygnn.py:576] : Epoch 84 train loss: 4.08e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2022-02-14 17:22:42,077 [phygnn.py:576] : Epoch 85 train loss: 4.10e-01 val loss: 3.97e-01 for "phygnn"
INFO - 2022-02-14 17:22:50,658 [phygnn.py:576] : Epoch 86 train loss: 4.09e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2022-02-14 17:22:58,918 [phygnn.py:576] : Epoch 87 train loss: 4.11e-01 val loss: 3.97e-01 for "phygnn"
INFO - 2022-02-14 17:23:07,214 [phygnn.py:576] : Epoch 88 train loss: 4.09e-01 val loss: 3.97e-01 for "phygnn"
INFO - 2022-02-14 17:23:15,757 [phygnn.py:576] : Epoch 89 train loss: 4.10e-01 val loss: 3.97e-01 for "phygnn"
INFO - 2022-02-14 17:23:24,311 [phygnn.py:576] : Epoch 90 train loss: 4.02e-01 val loss: 3.96e-01 for "phygnn"
INFO - 2022-02-14 17:23:32,476 [phygnn.py:576] : Epoch 91 train loss: 4.08e-01 val loss: 3.96e-01 for "phygnn"
INFO - 2022-02-14 17:23:40,192 [phygnn.py:576] : Epoch 92 train loss: 4.07e-01 val loss: 3.96e-01 for "phygnn"
INFO - 2022-02-14 17:23:48,024 [phygnn.py:576] : Epoch 93 train loss: 4.08e-01 val loss: 3.96e-01 for "phygnn"
INFO - 2022-02-14 17:23:56,028 [phygnn.py:576] : Epoch 94 train loss: 4.05e-01 val loss: 3.96e-01 for "phygnn"
INFO - 2022-02-14 17:24:04,342 [phygnn.py:576] : Epoch 95 train loss: 4.06e-01 val loss: 3.95e-01 for "phygnn"
INFO - 2022-02-14 17:24:12,050 [phygnn.py:576] : Epoch 96 train loss: 4.02e-01 val loss: 3.96e-01 for "phygnn"
INFO - 2022-02-14 17:24:20,292 [phygnn.py:576] : Epoch 97 train loss: 4.05e-01 val loss: 3.95e-01 for "phygnn"
INFO - 2022-02-14 17:24:28,287 [phygnn.py:576] : Epoch 98 train loss: 4.09e-01 val loss: 3.94e-01 for "phygnn"
INFO - 2022-02-14 17:24:36,006 [phygnn.py:576] : Epoch 99 train loss: 4.16e-01 val loss: 3.95e-01 for "phygnn"
INFO - 2022-02-14 17:24:36,641 [trainer.py:92] : Training part B - data and phygnn. Loss is [0.5, 0.5]
INFO - 2022-02-14 17:24:58,728 [phygnn.py:576] : Epoch 100 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2022-02-14 17:25:12,517 [phygnn.py:576] : Epoch 101 train loss: 2.72e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:25:24,842 [phygnn.py:576] : Epoch 102 train loss: 2.74e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2022-02-14 17:25:36,895 [phygnn.py:576] : Epoch 103 train loss: 2.79e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:25:50,661 [phygnn.py:576] : Epoch 104 train loss: 2.76e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:26:03,737 [phygnn.py:576] : Epoch 105 train loss: 2.78e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:26:17,900 [phygnn.py:576] : Epoch 106 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:26:30,228 [phygnn.py:576] : Epoch 107 train loss: 2.72e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:26:42,677 [phygnn.py:576] : Epoch 108 train loss: 2.75e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2022-02-14 17:26:56,404 [phygnn.py:576] : Epoch 109 train loss: 2.72e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2022-02-14 17:27:09,706 [phygnn.py:576] : Epoch 110 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:27:22,579 [phygnn.py:576] : Epoch 111 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2022-02-14 17:27:36,880 [phygnn.py:576] : Epoch 112 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:27:50,488 [phygnn.py:576] : Epoch 113 train loss: 2.72e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:28:04,282 [phygnn.py:576] : Epoch 114 train loss: 2.75e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2022-02-14 17:28:17,173 [phygnn.py:576] : Epoch 115 train loss: 2.72e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2022-02-14 17:28:30,446 [phygnn.py:576] : Epoch 116 train loss: 2.72e-01 val loss: 2.66e-01 for "phygnn"
ERROR - 2022-02-14 17:28:39,849 [phygnn.py:461] : phygnn calculated a NaN loss value!
Traceback (most recent call last):
  File "k_fold.py", line 55, in <module>
    t = Trainer(train_sites=train_sites, train_files=files, config=config)
  File "/home/gbuster/code/mlclouds/mlclouds/trainer.py", line 95, in __init__
    out = model.train_model(self.x, self.y, self.p,
  File "/home/gbuster/miniconda3/envs/nsrdb/lib/python3.8/site-packages/phygnn/model_interfaces/phygnn_model.py", line 177, in train_model
    diagnostics = self.model.fit(x, y, p,
  File "/home/gbuster/miniconda3/envs/nsrdb/lib/python3.8/site-packages/phygnn/phygnn.py", line 570, in fit
    tr_loss, tr_nn_loss, tr_p_loss = self.run_gradient_descent(
  File "/home/gbuster/miniconda3/envs/nsrdb/lib/python3.8/site-packages/phygnn/phygnn.py", line 482, in run_gradient_descent
    grad, loss, nn_loss, p_loss = self._get_grad(x, y_true, p, p_kwargs)
  File "/home/gbuster/miniconda3/envs/nsrdb/lib/python3.8/site-packages/phygnn/phygnn.py", line 473, in _get_grad
    loss, nn_loss, p_loss = self.calc_loss(y_true, y_predicted,
  File "/home/gbuster/miniconda3/envs/nsrdb/lib/python3.8/site-packages/phygnn/phygnn.py", line 462, in calc_loss
    raise ArithmeticError(msg)
ArithmeticError: phygnn calculated a NaN loss value!
