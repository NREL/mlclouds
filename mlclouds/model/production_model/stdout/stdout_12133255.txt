2023-04-13 11:57:53.769975: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2023-04-13 11:57:54.181904: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2023-04-13 11:57:54.182413: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-04-13 11:57:56.424061: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Number of files: 8
Number of east files: 4
Number of west files: 4
Source files: ['/projects/pxs/mlclouds/training_data/2016_east_v322/mlclouds_surfrad_east_2016.h5', '/projects/pxs/mlclouds/training_data/2016_west_v322/mlclouds_surfrad_west_2016.h5', '/projects/pxs/mlclouds/training_data/2017_east_v322/mlclouds_surfrad_east_2017.h5', '/projects/pxs/mlclouds/training_data/2017_west_v322/mlclouds_surfrad_west_2017.h5', '/projects/pxs/mlclouds/training_data/2018_east_v322/mlclouds_surfrad_east_2018.h5', '/projects/pxs/mlclouds/training_data/2018_west_v322/mlclouds_surfrad_west_2018.h5', '/projects/pxs/mlclouds/training_data/2019_east_v322/mlclouds_surfrad_east_2019.h5', '/projects/pxs/mlclouds/training_data/2019_west_v322/mlclouds_surfrad_west_2019.h5']
Full config: {'clean_training_data_kwargs': {'filter_clear': False, 'nan_option': 'interp'}, 'epochs_a': 100, 'epochs_b': 90, 'features': ['solar_zenith_angle', 'cloud_type', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo'], 'hidden_layers': [{'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}, {'activation': 'relu', 'dropout': 0.1, 'units': 256}], 'learning_rate': 0.0005, 'loss_weights_a': [1, 0], 'loss_weights_b': [0.5, 0.5], 'metric': 'relative_mae', 'n_batch': 64, 'one_hot_categories': {'flag': ['clear', 'ice_cloud', 'water_cloud', 'bad_cloud']}, 'p_fun': 'p_fun_all_sky', 'p_kwargs': {'loss_terms': ['mae_ghi']}, 'phygnn_seed': 0, 'surfrad_window_minutes': 15, 'y_labels': ['cld_opd_dcomp', 'cld_reff_dcomp']}
INFO - 2023-04-13 11:58:02,505 [trainer.py:40] : Trainer: Training on sites all from files ['/projects/pxs/mlclouds/training_data/2016_east_v322/mlclouds_surfrad_east_2016.h5', '/projects/pxs/mlclouds/training_data/2016_west_v322/mlclouds_surfrad_west_2016.h5', '/projects/pxs/mlclouds/training_data/2017_east_v322/mlclouds_surfrad_east_2017.h5', '/projects/pxs/mlclouds/training_data/2017_west_v322/mlclouds_surfrad_west_2017.h5', '/projects/pxs/mlclouds/training_data/2018_east_v322/mlclouds_surfrad_east_2018.h5', '/projects/pxs/mlclouds/training_data/2018_west_v322/mlclouds_surfrad_west_2018.h5', '/projects/pxs/mlclouds/training_data/2019_east_v322/mlclouds_surfrad_east_2019.h5', '/projects/pxs/mlclouds/training_data/2019_west_v322/mlclouds_surfrad_west_2019.h5']
INFO - 2023-04-13 11:58:02,512 [trainer.py:49] : Trainer: Training on sites [0, 1, 2, 3, 4, 5, 6, 7, 8] from files ['/projects/pxs/mlclouds/training_data/2016_east_v322/mlclouds_surfrad_east_2016.h5', '/projects/pxs/mlclouds/training_data/2016_west_v322/mlclouds_surfrad_west_2016.h5', '/projects/pxs/mlclouds/training_data/2017_east_v322/mlclouds_surfrad_east_2017.h5', '/projects/pxs/mlclouds/training_data/2017_west_v322/mlclouds_surfrad_west_2017.h5', '/projects/pxs/mlclouds/training_data/2018_east_v322/mlclouds_surfrad_east_2018.h5', '/projects/pxs/mlclouds/training_data/2018_west_v322/mlclouds_surfrad_west_2018.h5', '/projects/pxs/mlclouds/training_data/2019_east_v322/mlclouds_surfrad_east_2019.h5', '/projects/pxs/mlclouds/training_data/2019_west_v322/mlclouds_surfrad_west_2019.h5']
INFO - 2023-04-13 11:58:02,512 [data_handlers.py:60] : Loading training data
DEBUG - 2023-04-13 11:58:02,512 [data_handlers.py:78] : Loading vars ['solar_zenith_angle', 'cloud_type', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'cld_opd_dcomp', 'cld_reff_dcomp']
DEBUG - 2023-04-13 11:58:02,512 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 4, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2016_east_v322/mlclouds_surfrad_east_2016.h5
DEBUG - 2023-04-13 11:58:04,455 [data_handlers.py:103] : 	Shape temp_raw=(158112, 19), temp_all_sky=(158112, 14)
DEBUG - 2023-04-13 11:58:04,458 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2023-04-13 11:58:04,458 [data_handlers.py:110] : 	Grabbing surface data for 2016 and [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 11:58:04,462 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2016.h5
DEBUG - 2023-04-13 11:58:05,221 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:05,224 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2016.h5
DEBUG - 2023-04-13 11:58:05,975 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:05,978 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2016.h5
DEBUG - 2023-04-13 11:58:06,735 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:06,738 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2016.h5
DEBUG - 2023-04-13 11:58:07,485 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:07,488 [data_handlers.py:117] : 		Grabbing surface data for gwn from /projects/pxs/surfrad/h5/gwn_2016.h5
DEBUG - 2023-04-13 11:58:08,234 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:08,237 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2016.h5
DEBUG - 2023-04-13 11:58:08,971 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:08,975 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2016.h5
DEBUG - 2023-04-13 11:58:09,720 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:09,723 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2016.h5
DEBUG - 2023-04-13 11:58:10,517 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:10,520 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2016.h5
DEBUG - 2023-04-13 11:58:11,289 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:11,289 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 4, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2016_west_v322/mlclouds_surfrad_west_2016.h5
DEBUG - 2023-04-13 11:58:13,368 [data_handlers.py:103] : 	Shape temp_raw=(158112, 19), temp_all_sky=(158112, 14)
DEBUG - 2023-04-13 11:58:13,371 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2023-04-13 11:58:13,371 [data_handlers.py:110] : 	Grabbing surface data for 2016 and [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 11:58:13,374 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2016.h5
DEBUG - 2023-04-13 11:58:14,057 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:14,059 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2016.h5
DEBUG - 2023-04-13 11:58:14,740 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:14,743 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2016.h5
DEBUG - 2023-04-13 11:58:15,427 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:15,430 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2016.h5
DEBUG - 2023-04-13 11:58:16,104 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:16,107 [data_handlers.py:117] : 		Grabbing surface data for gwn from /projects/pxs/surfrad/h5/gwn_2016.h5
DEBUG - 2023-04-13 11:58:16,786 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:16,789 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2016.h5
DEBUG - 2023-04-13 11:58:17,472 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:17,475 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2016.h5
DEBUG - 2023-04-13 11:58:18,155 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:18,158 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2016.h5
DEBUG - 2023-04-13 11:58:18,845 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:18,848 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2016.h5
DEBUG - 2023-04-13 11:58:19,523 [data_handlers.py:135] : 	Shape: temp_surf=(17568, 5)
DEBUG - 2023-04-13 11:58:19,523 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 4, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2017_east_v322/mlclouds_surfrad_east_2017.h5
DEBUG - 2023-04-13 11:58:21,441 [data_handlers.py:103] : 	Shape temp_raw=(157680, 19), temp_all_sky=(157680, 14)
DEBUG - 2023-04-13 11:58:21,445 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2023-04-13 11:58:21,445 [data_handlers.py:110] : 	Grabbing surface data for 2017 and [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 11:58:21,448 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2017.h5
DEBUG - 2023-04-13 11:58:22,198 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:22,201 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2017.h5
DEBUG - 2023-04-13 11:58:22,939 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:22,942 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2017.h5
DEBUG - 2023-04-13 11:58:23,693 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:23,696 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2017.h5
DEBUG - 2023-04-13 11:58:24,433 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:24,436 [data_handlers.py:117] : 		Grabbing surface data for gwn from /projects/pxs/surfrad/h5/gwn_2017.h5
DEBUG - 2023-04-13 11:58:25,185 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:25,188 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2017.h5
DEBUG - 2023-04-13 11:58:25,935 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:25,938 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2017.h5
DEBUG - 2023-04-13 11:58:26,680 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:26,683 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2017.h5
DEBUG - 2023-04-13 11:58:27,399 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:27,402 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2017.h5
DEBUG - 2023-04-13 11:58:28,173 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:28,173 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 4, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2017_west_v322/mlclouds_surfrad_west_2017.h5
DEBUG - 2023-04-13 11:58:30,092 [data_handlers.py:103] : 	Shape temp_raw=(157680, 19), temp_all_sky=(157680, 14)
DEBUG - 2023-04-13 11:58:30,095 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2023-04-13 11:58:30,095 [data_handlers.py:110] : 	Grabbing surface data for 2017 and [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 11:58:30,098 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2017.h5
DEBUG - 2023-04-13 11:58:30,780 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:30,783 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2017.h5
DEBUG - 2023-04-13 11:58:31,468 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:31,471 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2017.h5
DEBUG - 2023-04-13 11:58:32,146 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:32,149 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2017.h5
DEBUG - 2023-04-13 11:58:32,840 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:32,842 [data_handlers.py:117] : 		Grabbing surface data for gwn from /projects/pxs/surfrad/h5/gwn_2017.h5
DEBUG - 2023-04-13 11:58:33,518 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:33,521 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2017.h5
DEBUG - 2023-04-13 11:58:34,191 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:34,194 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2017.h5
DEBUG - 2023-04-13 11:58:34,882 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:34,885 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2017.h5
DEBUG - 2023-04-13 11:58:35,557 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:35,560 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2017.h5
DEBUG - 2023-04-13 11:58:36,235 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:36,235 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 4, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2018_east_v322/mlclouds_surfrad_east_2018.h5
DEBUG - 2023-04-13 11:58:48,398 [data_handlers.py:103] : 	Shape temp_raw=(946080, 19), temp_all_sky=(946080, 14)
DEBUG - 2023-04-13 11:58:48,417 [data_handlers.py:106] : 	Time step is 5 minutes
DEBUG - 2023-04-13 11:58:48,417 [data_handlers.py:110] : 	Grabbing surface data for 2018 and [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 11:58:48,420 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2018.h5
DEBUG - 2023-04-13 11:58:49,162 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:58:49,165 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2018.h5
DEBUG - 2023-04-13 11:58:49,899 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:58:49,902 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2018.h5
DEBUG - 2023-04-13 11:58:50,638 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:58:50,642 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2018.h5
DEBUG - 2023-04-13 11:58:51,375 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:58:51,378 [data_handlers.py:117] : 		Grabbing surface data for gwn from /projects/pxs/surfrad/h5/gwn_2018.h5
DEBUG - 2023-04-13 11:58:52,120 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:58:52,123 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2018.h5
DEBUG - 2023-04-13 11:58:52,860 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:58:52,863 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2018.h5
DEBUG - 2023-04-13 11:58:53,596 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:58:53,599 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2018.h5
DEBUG - 2023-04-13 11:58:54,341 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:58:54,344 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2018.h5
DEBUG - 2023-04-13 11:58:55,118 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:58:55,118 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 4, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2018_west_v322/mlclouds_surfrad_west_2018.h5
DEBUG - 2023-04-13 11:58:57,055 [data_handlers.py:103] : 	Shape temp_raw=(157680, 19), temp_all_sky=(157680, 14)
DEBUG - 2023-04-13 11:58:57,059 [data_handlers.py:106] : 	Time step is 30 minutes
DEBUG - 2023-04-13 11:58:57,059 [data_handlers.py:110] : 	Grabbing surface data for 2018 and [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 11:58:57,062 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2018.h5
DEBUG - 2023-04-13 11:58:57,738 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:57,741 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2018.h5
DEBUG - 2023-04-13 11:58:58,415 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:58,418 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2018.h5
DEBUG - 2023-04-13 11:58:59,094 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:59,097 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2018.h5
DEBUG - 2023-04-13 11:58:59,776 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:58:59,779 [data_handlers.py:117] : 		Grabbing surface data for gwn from /projects/pxs/surfrad/h5/gwn_2018.h5
DEBUG - 2023-04-13 11:59:00,456 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:59:00,459 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2018.h5
DEBUG - 2023-04-13 11:59:01,145 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:59:01,148 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2018.h5
DEBUG - 2023-04-13 11:59:01,826 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:59:01,829 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2018.h5
DEBUG - 2023-04-13 11:59:02,501 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:59:02,504 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2018.h5
DEBUG - 2023-04-13 11:59:03,189 [data_handlers.py:135] : 	Shape: temp_surf=(17520, 5)
DEBUG - 2023-04-13 11:59:03,189 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 4, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2019_east_v322/mlclouds_surfrad_east_2019.h5
DEBUG - 2023-04-13 11:59:15,293 [data_handlers.py:103] : 	Shape temp_raw=(946080, 19), temp_all_sky=(946080, 14)
DEBUG - 2023-04-13 11:59:15,311 [data_handlers.py:106] : 	Time step is 5 minutes
DEBUG - 2023-04-13 11:59:15,311 [data_handlers.py:110] : 	Grabbing surface data for 2019 and [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 11:59:15,314 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2019.h5
DEBUG - 2023-04-13 11:59:16,062 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:59:16,065 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2019.h5
DEBUG - 2023-04-13 11:59:16,824 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:59:16,827 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2019.h5
DEBUG - 2023-04-13 11:59:17,567 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:59:17,570 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2019.h5
DEBUG - 2023-04-13 11:59:18,322 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:59:18,325 [data_handlers.py:117] : 		Grabbing surface data for gwn from /projects/pxs/surfrad/h5/gwn_2019.h5
DEBUG - 2023-04-13 11:59:19,068 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:59:19,072 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2019.h5
DEBUG - 2023-04-13 11:59:19,821 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:59:19,824 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2019.h5
DEBUG - 2023-04-13 11:59:20,547 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:59:20,550 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2019.h5
DEBUG - 2023-04-13 11:59:21,284 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:59:21,287 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2019.h5
DEBUG - 2023-04-13 11:59:22,066 [data_handlers.py:135] : 	Shape: temp_surf=(105120, 5)
DEBUG - 2023-04-13 11:59:22,067 [data_handlers.py:85] : Loading data for site(s) [0, 1, 2, 3, 4, 5, 6, 7, 8], from /projects/pxs/mlclouds/training_data/2019_west_v322/mlclouds_surfrad_west_2019.h5
DEBUG - 2023-04-13 11:59:28,197 [data_handlers.py:103] : 	Shape temp_raw=(473040, 19), temp_all_sky=(473040, 14)
DEBUG - 2023-04-13 11:59:28,207 [data_handlers.py:106] : 	Time step is 10 minutes
DEBUG - 2023-04-13 11:59:28,208 [data_handlers.py:110] : 	Grabbing surface data for 2019 and [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 11:59:28,211 [data_handlers.py:117] : 		Grabbing surface data for bon from /projects/pxs/surfrad/h5/bon_2019.h5
DEBUG - 2023-04-13 11:59:28,917 [data_handlers.py:135] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2023-04-13 11:59:28,920 [data_handlers.py:117] : 		Grabbing surface data for tbl from /projects/pxs/surfrad/h5/tbl_2019.h5
DEBUG - 2023-04-13 11:59:29,638 [data_handlers.py:135] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2023-04-13 11:59:29,641 [data_handlers.py:117] : 		Grabbing surface data for dra from /projects/pxs/surfrad/h5/dra_2019.h5
DEBUG - 2023-04-13 11:59:30,356 [data_handlers.py:135] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2023-04-13 11:59:30,360 [data_handlers.py:117] : 		Grabbing surface data for fpk from /projects/pxs/surfrad/h5/fpk_2019.h5
DEBUG - 2023-04-13 11:59:31,079 [data_handlers.py:135] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2023-04-13 11:59:31,082 [data_handlers.py:117] : 		Grabbing surface data for gwn from /projects/pxs/surfrad/h5/gwn_2019.h5
DEBUG - 2023-04-13 11:59:31,789 [data_handlers.py:135] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2023-04-13 11:59:31,792 [data_handlers.py:117] : 		Grabbing surface data for psu from /projects/pxs/surfrad/h5/psu_2019.h5
DEBUG - 2023-04-13 11:59:32,502 [data_handlers.py:135] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2023-04-13 11:59:32,506 [data_handlers.py:117] : 		Grabbing surface data for sxf from /projects/pxs/surfrad/h5/sxf_2019.h5
DEBUG - 2023-04-13 11:59:33,226 [data_handlers.py:135] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2023-04-13 11:59:33,229 [data_handlers.py:117] : 		Grabbing surface data for sgp from /projects/pxs/surfrad/h5/sgp_2019.h5
DEBUG - 2023-04-13 11:59:33,944 [data_handlers.py:135] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2023-04-13 11:59:33,947 [data_handlers.py:117] : 		Grabbing surface data for srrl from /projects/pxs/surfrad/h5/srrl_2019.h5
DEBUG - 2023-04-13 11:59:34,659 [data_handlers.py:135] : 	Shape: temp_surf=(52560, 5)
DEBUG - 2023-04-13 11:59:34,659 [data_handlers.py:137] : Data load complete. Shape df_raw=(3154464, 19), df_all_sky=(3154464, 14), df_surf=(3154464, 5)
DEBUG - 2023-04-13 11:59:35,713 [data_handlers.py:285] : Creating test set; 20.0% of full data set
DEBUG - 2023-04-13 11:59:37,546 [data_handlers.py:301] : Train set shape: df_raw=(2523571, 19), df_all_sky=(2523571, 17)
DEBUG - 2023-04-13 11:59:37,689 [data_handlers.py:303] : Test set shape: df_raw=(630893, 19), df_all_sky=(630893, 17)
DEBUG - 2023-04-13 11:59:37,689 [data_handlers.py:162] : Extracting 2D arrays to run rest2 for clearsky PhyGNN inputs.
DEBUG - 2023-04-13 11:59:49,575 [data_handlers.py:179] : Running rest2 for clearsky PhyGNN inputs.
DEBUG - 2023-04-13 12:01:32,359 [data_handlers.py:197] : Completed rest2 run for clearsky PhyGNN inputs.
INFO - 2023-04-13 12:01:33,486 [data_handlers.py:62] : Prepping training data
DEBUG - 2023-04-13 12:01:33,486 [data_handlers.py:218] : Training data clean kwargs: {'filter_daylight': True, 'filter_clear': False, 'add_cloud_flag': True, 'sza_lim': 89, 'nan_option': 'interp'}
DEBUG - 2023-04-13 12:01:33,486 [data_handlers.py:219] : Shape before cleaning: df_raw=(2523571, 19)
INFO - 2023-04-13 12:01:34,512 [data_cleaners.py:36] : 49.69% of timesteps are daylight
INFO - 2023-04-13 12:01:34,515 [data_cleaners.py:38] : 52.35% of daylight timesteps are cloudy
INFO - 2023-04-13 12:01:34,517 [data_cleaners.py:40] : 3.26% of daylight timesteps are missing cloud type
INFO - 2023-04-13 12:01:34,520 [data_cleaners.py:42] : 34.01% of cloudy daylight timesteps are missing cloud opd
INFO - 2023-04-13 12:01:34,522 [data_cleaners.py:44] : 34.23% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2023-04-13 12:01:34,522 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2023-04-13 12:01:34,524 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:34,527 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:34,530 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:34,535 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:34,537 [data_cleaners.py:50] : 	"refl_0_65um_nom" has 51.45% NaN values
DEBUG - 2023-04-13 12:01:34,540 [data_cleaners.py:50] : 	"refl_0_65um_nom_stddev_3x3" has 51.45% NaN values
DEBUG - 2023-04-13 12:01:34,542 [data_cleaners.py:50] : 	"refl_3_75um_nom" has 3.29% NaN values
DEBUG - 2023-04-13 12:01:34,545 [data_cleaners.py:50] : 	"temp_3_75um_nom" has 3.19% NaN values
DEBUG - 2023-04-13 12:01:34,548 [data_cleaners.py:50] : 	"temp_11_0um_nom" has 3.19% NaN values
DEBUG - 2023-04-13 12:01:34,550 [data_cleaners.py:50] : 	"temp_11_0um_nom_stddev_3x3" has 3.27% NaN values
DEBUG - 2023-04-13 12:01:34,553 [data_cleaners.py:50] : 	"cloud_probability" has 3.27% NaN values
DEBUG - 2023-04-13 12:01:34,555 [data_cleaners.py:50] : 	"cloud_fraction" has 3.27% NaN values
DEBUG - 2023-04-13 12:01:34,558 [data_cleaners.py:50] : 	"air_temperature" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:34,561 [data_cleaners.py:50] : 	"dew_point" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:34,563 [data_cleaners.py:50] : 	"relative_humidity" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:34,566 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:34,568 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:34,571 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 82.83% NaN values
DEBUG - 2023-04-13 12:01:34,573 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 82.89% NaN values
DEBUG - 2023-04-13 12:01:34,573 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2023-04-13 12:01:36,768 [data_cleaners.py:79] : Adding cloud type flag (e.g. flag=[night, clear, ice_cloud, water_cloud, bad_cloud])
INFO - 2023-04-13 12:01:37,597 [data_cleaners.py:99] : Data reduced from 2523571 rows to 1253916 after filters (49.69% of original)
DEBUG - 2023-04-13 12:01:37,707 [data_cleaners.py:105] : Feature flag column has these values: ['clear' 'bad_cloud' 'water_cloud' 'ice_cloud']
INFO - 2023-04-13 12:01:37,707 [data_cleaners.py:107] : Cleaning took 4.2 seconds
DEBUG - 2023-04-13 12:01:37,708 [data_handlers.py:222] : Shape after cleaning: df_train=(1253916, 20)
DEBUG - 2023-04-13 12:01:37,708 [data_handlers.py:225] : Cleaning df_all_sky training data (for pfun).
DEBUG - 2023-04-13 12:01:37,708 [data_handlers.py:226] : Shape before cleaning: df_all_sky=(2523571, 25)
INFO - 2023-04-13 12:01:38,873 [data_cleaners.py:36] : 49.69% of timesteps are daylight
INFO - 2023-04-13 12:01:38,876 [data_cleaners.py:38] : 52.35% of daylight timesteps are cloudy
INFO - 2023-04-13 12:01:38,878 [data_cleaners.py:40] : 3.26% of daylight timesteps are missing cloud type
INFO - 2023-04-13 12:01:38,881 [data_cleaners.py:42] : 34.01% of cloudy daylight timesteps are missing cloud opd
INFO - 2023-04-13 12:01:38,883 [data_cleaners.py:44] : 34.23% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2023-04-13 12:01:38,883 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2023-04-13 12:01:38,885 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,887 [data_cleaners.py:50] : 	"alpha" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,890 [data_cleaners.py:50] : 	"aod" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,893 [data_cleaners.py:50] : 	"asymmetry" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,897 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,900 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 82.83% NaN values
DEBUG - 2023-04-13 12:01:38,902 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 82.89% NaN values
DEBUG - 2023-04-13 12:01:38,905 [data_cleaners.py:50] : 	"ozone" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,907 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,910 [data_cleaners.py:50] : 	"ssa" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,913 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,914 [data_cleaners.py:50] : 	"surface_pressure" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,916 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,920 [data_cleaners.py:50] : 	"surfrad_dhi" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,924 [data_cleaners.py:50] : 	"surfrad_dni" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,928 [data_cleaners.py:50] : 	"surfrad_ghi" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,929 [data_cleaners.py:50] : 	"doy" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,933 [data_cleaners.py:50] : 	"radius" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,937 [data_cleaners.py:50] : 	"Tuuclr" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,940 [data_cleaners.py:50] : 	"clearsky_ghi" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,944 [data_cleaners.py:50] : 	"clearsky_dni" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,948 [data_cleaners.py:50] : 	"Ruuclr" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,951 [data_cleaners.py:50] : 	"Tddclr" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,955 [data_cleaners.py:50] : 	"Tduclr" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,959 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2023-04-13 12:01:38,959 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2023-04-13 12:01:40,570 [data_cleaners.py:79] : Adding cloud type flag (e.g. flag=[night, clear, ice_cloud, water_cloud, bad_cloud])
INFO - 2023-04-13 12:01:41,399 [data_cleaners.py:99] : Data reduced from 2523571 rows to 1253916 after filters (49.69% of original)
DEBUG - 2023-04-13 12:01:41,540 [data_cleaners.py:105] : Feature flag column has these values: ['clear' 'bad_cloud' 'water_cloud' 'ice_cloud']
INFO - 2023-04-13 12:01:41,541 [data_cleaners.py:107] : Cleaning took 3.8 seconds
DEBUG - 2023-04-13 12:01:41,542 [data_handlers.py:230] : Shape after cleaning: df_all_sky=(1253916, 26)
DEBUG - 2023-04-13 12:01:41,644 [data_handlers.py:244] : **Shape: df_train=(1253916, 17)
DEBUG - 2023-04-13 12:01:41,675 [data_handlers.py:254] : Shapes: x=(1253916, 15), y=(1253916, 2), p=(1253916, 26)
DEBUG - 2023-04-13 12:01:41,675 [data_handlers.py:257] : Training features: ['solar_zenith_angle', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'flag']
INFO - 2023-04-13 12:01:41,675 [data_handlers.py:332] : Saving training data to: ./mlclouds_training_data.csv
DEBUG - 2023-04-13 12:02:14,110 [trainer.py:67] : Building PHYGNN model
INFO - 2023-04-13 12:02:14,110 [trainer.py:70] : Using p_fun: <function p_fun_all_sky at 0x2b8ce17f58b0>
INFO - 2023-04-13 12:02:14,111 [base.py:90] : Active python environment versions: 
{   'nrel-rex': '0.2.80',
    'numpy': '1.23.5',
    'pandas': '2.0.0',
    'phygnn': '0.0.23',
    'python': '3.9.16 (main, Mar  8 2023, 14:00:05) \n[GCC 11.2.0]',
    'sklearn': '1.2.2',
    'tensorflow': '2.12.0'}
INFO - 2023-04-13 12:02:14,123 [base.py:108] : Successfully initialized model with 17 layers
INFO - 2023-04-13 12:02:14,170 [base_model.py:78] : Active python environment versions: 
{   'nrel-rex': '0.2.80',
    'numpy': '1.23.5',
    'pandas': '2.0.0',
    'phygnn': '0.0.23',
    'python': '3.9.16 (main, Mar  8 2023, 14:00:05) \n[GCC 11.2.0]',
    'sklearn': '1.2.2',
    'tensorflow': '2.12.0'}
INFO - 2023-04-13 12:02:14,170 [trainer.py:84] : Training part A - pure data. Loss is [1, 0]
/projects/pxs/gbuster/nsrdb_env_2023/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
INFO - 2023-04-13 12:02:30,920 [phygnn.py:594] : Epoch 0 train loss: 7.42e-01 val loss: 5.99e-01 for "phygnn"
INFO - 2023-04-13 12:02:40,825 [phygnn.py:594] : Epoch 1 train loss: 5.64e-01 val loss: 5.16e-01 for "phygnn"
INFO - 2023-04-13 12:02:50,775 [phygnn.py:594] : Epoch 2 train loss: 5.18e-01 val loss: 4.90e-01 for "phygnn"
INFO - 2023-04-13 12:03:00,743 [phygnn.py:594] : Epoch 3 train loss: 5.02e-01 val loss: 4.82e-01 for "phygnn"
INFO - 2023-04-13 12:03:10,751 [phygnn.py:594] : Epoch 4 train loss: 4.93e-01 val loss: 4.74e-01 for "phygnn"
INFO - 2023-04-13 12:03:20,403 [phygnn.py:594] : Epoch 5 train loss: 4.87e-01 val loss: 4.70e-01 for "phygnn"
INFO - 2023-04-13 12:03:30,019 [phygnn.py:594] : Epoch 6 train loss: 4.82e-01 val loss: 4.68e-01 for "phygnn"
INFO - 2023-04-13 12:03:39,910 [phygnn.py:594] : Epoch 7 train loss: 4.78e-01 val loss: 4.62e-01 for "phygnn"
INFO - 2023-04-13 12:03:49,799 [phygnn.py:594] : Epoch 8 train loss: 4.74e-01 val loss: 4.61e-01 for "phygnn"
INFO - 2023-04-13 12:03:59,496 [phygnn.py:594] : Epoch 9 train loss: 4.72e-01 val loss: 4.58e-01 for "phygnn"
INFO - 2023-04-13 12:04:09,188 [phygnn.py:594] : Epoch 10 train loss: 4.69e-01 val loss: 4.55e-01 for "phygnn"
INFO - 2023-04-13 12:04:18,835 [phygnn.py:594] : Epoch 11 train loss: 4.66e-01 val loss: 4.53e-01 for "phygnn"
INFO - 2023-04-13 12:04:28,562 [phygnn.py:594] : Epoch 12 train loss: 4.64e-01 val loss: 4.53e-01 for "phygnn"
INFO - 2023-04-13 12:04:38,096 [phygnn.py:594] : Epoch 13 train loss: 4.61e-01 val loss: 4.51e-01 for "phygnn"
INFO - 2023-04-13 12:04:47,599 [phygnn.py:594] : Epoch 14 train loss: 4.60e-01 val loss: 4.46e-01 for "phygnn"
INFO - 2023-04-13 12:04:57,263 [phygnn.py:594] : Epoch 15 train loss: 4.57e-01 val loss: 4.43e-01 for "phygnn"
INFO - 2023-04-13 12:05:07,009 [phygnn.py:594] : Epoch 16 train loss: 4.55e-01 val loss: 4.42e-01 for "phygnn"
INFO - 2023-04-13 12:05:16,674 [phygnn.py:594] : Epoch 17 train loss: 4.53e-01 val loss: 4.40e-01 for "phygnn"
INFO - 2023-04-13 12:05:26,409 [phygnn.py:594] : Epoch 18 train loss: 4.52e-01 val loss: 4.38e-01 for "phygnn"
INFO - 2023-04-13 12:05:36,035 [phygnn.py:594] : Epoch 19 train loss: 4.51e-01 val loss: 4.37e-01 for "phygnn"
INFO - 2023-04-13 12:05:45,638 [phygnn.py:594] : Epoch 20 train loss: 4.49e-01 val loss: 4.38e-01 for "phygnn"
INFO - 2023-04-13 12:05:55,502 [phygnn.py:594] : Epoch 21 train loss: 4.48e-01 val loss: 4.34e-01 for "phygnn"
INFO - 2023-04-13 12:06:05,154 [phygnn.py:594] : Epoch 22 train loss: 4.47e-01 val loss: 4.37e-01 for "phygnn"
INFO - 2023-04-13 12:06:14,833 [phygnn.py:594] : Epoch 23 train loss: 4.46e-01 val loss: 4.35e-01 for "phygnn"
INFO - 2023-04-13 12:06:24,604 [phygnn.py:594] : Epoch 24 train loss: 4.45e-01 val loss: 4.33e-01 for "phygnn"
INFO - 2023-04-13 12:06:34,263 [phygnn.py:594] : Epoch 25 train loss: 4.44e-01 val loss: 4.31e-01 for "phygnn"
INFO - 2023-04-13 12:06:43,907 [phygnn.py:594] : Epoch 26 train loss: 4.43e-01 val loss: 4.29e-01 for "phygnn"
INFO - 2023-04-13 12:06:53,541 [phygnn.py:594] : Epoch 27 train loss: 4.42e-01 val loss: 4.31e-01 for "phygnn"
INFO - 2023-04-13 12:07:03,154 [phygnn.py:594] : Epoch 28 train loss: 4.41e-01 val loss: 4.30e-01 for "phygnn"
INFO - 2023-04-13 12:07:12,776 [phygnn.py:594] : Epoch 29 train loss: 4.40e-01 val loss: 4.27e-01 for "phygnn"
INFO - 2023-04-13 12:07:22,368 [phygnn.py:594] : Epoch 30 train loss: 4.39e-01 val loss: 4.28e-01 for "phygnn"
INFO - 2023-04-13 12:07:32,312 [phygnn.py:594] : Epoch 31 train loss: 4.38e-01 val loss: 4.26e-01 for "phygnn"
INFO - 2023-04-13 12:07:42,092 [phygnn.py:594] : Epoch 32 train loss: 4.37e-01 val loss: 4.26e-01 for "phygnn"
INFO - 2023-04-13 12:07:51,807 [phygnn.py:594] : Epoch 33 train loss: 4.37e-01 val loss: 4.27e-01 for "phygnn"
INFO - 2023-04-13 12:08:01,514 [phygnn.py:594] : Epoch 34 train loss: 4.36e-01 val loss: 4.23e-01 for "phygnn"
INFO - 2023-04-13 12:08:11,275 [phygnn.py:594] : Epoch 35 train loss: 4.35e-01 val loss: 4.23e-01 for "phygnn"
INFO - 2023-04-13 12:08:20,955 [phygnn.py:594] : Epoch 36 train loss: 4.34e-01 val loss: 4.23e-01 for "phygnn"
INFO - 2023-04-13 12:08:30,613 [phygnn.py:594] : Epoch 37 train loss: 4.34e-01 val loss: 4.22e-01 for "phygnn"
INFO - 2023-04-13 12:08:40,275 [phygnn.py:594] : Epoch 38 train loss: 4.33e-01 val loss: 4.22e-01 for "phygnn"
INFO - 2023-04-13 12:08:50,079 [phygnn.py:594] : Epoch 39 train loss: 4.32e-01 val loss: 4.21e-01 for "phygnn"
INFO - 2023-04-13 12:08:59,619 [phygnn.py:594] : Epoch 40 train loss: 4.31e-01 val loss: 4.19e-01 for "phygnn"
INFO - 2023-04-13 12:09:09,530 [phygnn.py:594] : Epoch 41 train loss: 4.31e-01 val loss: 4.20e-01 for "phygnn"
INFO - 2023-04-13 12:09:19,298 [phygnn.py:594] : Epoch 42 train loss: 4.30e-01 val loss: 4.18e-01 for "phygnn"
INFO - 2023-04-13 12:09:28,891 [phygnn.py:594] : Epoch 43 train loss: 4.30e-01 val loss: 4.19e-01 for "phygnn"
INFO - 2023-04-13 12:09:38,718 [phygnn.py:594] : Epoch 44 train loss: 4.29e-01 val loss: 4.16e-01 for "phygnn"
INFO - 2023-04-13 12:09:48,333 [phygnn.py:594] : Epoch 45 train loss: 4.29e-01 val loss: 4.17e-01 for "phygnn"
INFO - 2023-04-13 12:09:58,025 [phygnn.py:594] : Epoch 46 train loss: 4.28e-01 val loss: 4.16e-01 for "phygnn"
INFO - 2023-04-13 12:10:07,663 [phygnn.py:594] : Epoch 47 train loss: 4.28e-01 val loss: 4.15e-01 for "phygnn"
INFO - 2023-04-13 12:10:17,177 [phygnn.py:594] : Epoch 48 train loss: 4.27e-01 val loss: 4.17e-01 for "phygnn"
INFO - 2023-04-13 12:10:26,711 [phygnn.py:594] : Epoch 49 train loss: 4.26e-01 val loss: 4.15e-01 for "phygnn"
INFO - 2023-04-13 12:10:36,304 [phygnn.py:594] : Epoch 50 train loss: 4.26e-01 val loss: 4.16e-01 for "phygnn"
INFO - 2023-04-13 12:10:45,900 [phygnn.py:594] : Epoch 51 train loss: 4.25e-01 val loss: 4.15e-01 for "phygnn"
INFO - 2023-04-13 12:10:55,724 [phygnn.py:594] : Epoch 52 train loss: 4.25e-01 val loss: 4.14e-01 for "phygnn"
INFO - 2023-04-13 12:11:05,266 [phygnn.py:594] : Epoch 53 train loss: 4.24e-01 val loss: 4.16e-01 for "phygnn"
INFO - 2023-04-13 12:11:14,897 [phygnn.py:594] : Epoch 54 train loss: 4.24e-01 val loss: 4.12e-01 for "phygnn"
INFO - 2023-04-13 12:11:24,533 [phygnn.py:594] : Epoch 55 train loss: 4.23e-01 val loss: 4.13e-01 for "phygnn"
INFO - 2023-04-13 12:11:34,195 [phygnn.py:594] : Epoch 56 train loss: 4.23e-01 val loss: 4.14e-01 for "phygnn"
INFO - 2023-04-13 12:11:43,865 [phygnn.py:594] : Epoch 57 train loss: 4.23e-01 val loss: 4.12e-01 for "phygnn"
INFO - 2023-04-13 12:11:53,407 [phygnn.py:594] : Epoch 58 train loss: 4.22e-01 val loss: 4.10e-01 for "phygnn"
INFO - 2023-04-13 12:12:02,837 [phygnn.py:594] : Epoch 59 train loss: 4.21e-01 val loss: 4.10e-01 for "phygnn"
INFO - 2023-04-13 12:12:12,549 [phygnn.py:594] : Epoch 60 train loss: 4.22e-01 val loss: 4.12e-01 for "phygnn"
INFO - 2023-04-13 12:12:22,164 [phygnn.py:594] : Epoch 61 train loss: 4.21e-01 val loss: 4.10e-01 for "phygnn"
INFO - 2023-04-13 12:12:31,719 [phygnn.py:594] : Epoch 62 train loss: 4.20e-01 val loss: 4.10e-01 for "phygnn"
INFO - 2023-04-13 12:12:41,280 [phygnn.py:594] : Epoch 63 train loss: 4.20e-01 val loss: 4.10e-01 for "phygnn"
INFO - 2023-04-13 12:12:50,784 [phygnn.py:594] : Epoch 64 train loss: 4.19e-01 val loss: 4.09e-01 for "phygnn"
INFO - 2023-04-13 12:13:00,536 [phygnn.py:594] : Epoch 65 train loss: 4.19e-01 val loss: 4.09e-01 for "phygnn"
INFO - 2023-04-13 12:13:10,299 [phygnn.py:594] : Epoch 66 train loss: 4.18e-01 val loss: 4.07e-01 for "phygnn"
INFO - 2023-04-13 12:13:19,897 [phygnn.py:594] : Epoch 67 train loss: 4.18e-01 val loss: 4.07e-01 for "phygnn"
INFO - 2023-04-13 12:13:29,903 [phygnn.py:594] : Epoch 68 train loss: 4.18e-01 val loss: 4.07e-01 for "phygnn"
INFO - 2023-04-13 12:13:39,770 [phygnn.py:594] : Epoch 69 train loss: 4.17e-01 val loss: 4.06e-01 for "phygnn"
INFO - 2023-04-13 12:13:49,507 [phygnn.py:594] : Epoch 70 train loss: 4.16e-01 val loss: 4.06e-01 for "phygnn"
INFO - 2023-04-13 12:13:59,288 [phygnn.py:594] : Epoch 71 train loss: 4.16e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2023-04-13 12:14:08,895 [phygnn.py:594] : Epoch 72 train loss: 4.16e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2023-04-13 12:14:18,407 [phygnn.py:594] : Epoch 73 train loss: 4.16e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2023-04-13 12:14:27,807 [phygnn.py:594] : Epoch 74 train loss: 4.15e-01 val loss: 4.05e-01 for "phygnn"
INFO - 2023-04-13 12:14:37,441 [phygnn.py:594] : Epoch 75 train loss: 4.15e-01 val loss: 4.04e-01 for "phygnn"
INFO - 2023-04-13 12:14:47,079 [phygnn.py:594] : Epoch 76 train loss: 4.14e-01 val loss: 4.04e-01 for "phygnn"
INFO - 2023-04-13 12:14:56,705 [phygnn.py:594] : Epoch 77 train loss: 4.14e-01 val loss: 4.03e-01 for "phygnn"
INFO - 2023-04-13 12:15:06,327 [phygnn.py:594] : Epoch 78 train loss: 4.13e-01 val loss: 4.04e-01 for "phygnn"
INFO - 2023-04-13 12:15:15,922 [phygnn.py:594] : Epoch 79 train loss: 4.13e-01 val loss: 4.02e-01 for "phygnn"
INFO - 2023-04-13 12:15:25,383 [phygnn.py:594] : Epoch 80 train loss: 4.13e-01 val loss: 4.01e-01 for "phygnn"
INFO - 2023-04-13 12:15:34,899 [phygnn.py:594] : Epoch 81 train loss: 4.12e-01 val loss: 4.02e-01 for "phygnn"
INFO - 2023-04-13 12:15:44,415 [phygnn.py:594] : Epoch 82 train loss: 4.12e-01 val loss: 4.02e-01 for "phygnn"
INFO - 2023-04-13 12:15:54,065 [phygnn.py:594] : Epoch 83 train loss: 4.11e-01 val loss: 4.01e-01 for "phygnn"
INFO - 2023-04-13 12:16:03,642 [phygnn.py:594] : Epoch 84 train loss: 4.12e-01 val loss: 4.01e-01 for "phygnn"
INFO - 2023-04-13 12:16:13,183 [phygnn.py:594] : Epoch 85 train loss: 4.11e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2023-04-13 12:16:22,757 [phygnn.py:594] : Epoch 86 train loss: 4.10e-01 val loss: 4.00e-01 for "phygnn"
INFO - 2023-04-13 12:16:32,317 [phygnn.py:594] : Epoch 87 train loss: 4.10e-01 val loss: 4.01e-01 for "phygnn"
INFO - 2023-04-13 12:16:41,937 [phygnn.py:594] : Epoch 88 train loss: 4.10e-01 val loss: 3.99e-01 for "phygnn"
INFO - 2023-04-13 12:16:51,607 [phygnn.py:594] : Epoch 89 train loss: 4.09e-01 val loss: 3.99e-01 for "phygnn"
INFO - 2023-04-13 12:17:01,229 [phygnn.py:594] : Epoch 90 train loss: 4.09e-01 val loss: 3.99e-01 for "phygnn"
INFO - 2023-04-13 12:17:10,998 [phygnn.py:594] : Epoch 91 train loss: 4.09e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2023-04-13 12:17:20,664 [phygnn.py:594] : Epoch 92 train loss: 4.08e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2023-04-13 12:17:30,263 [phygnn.py:594] : Epoch 93 train loss: 4.08e-01 val loss: 3.97e-01 for "phygnn"
INFO - 2023-04-13 12:17:39,912 [phygnn.py:594] : Epoch 94 train loss: 4.08e-01 val loss: 3.97e-01 for "phygnn"
INFO - 2023-04-13 12:17:49,513 [phygnn.py:594] : Epoch 95 train loss: 4.07e-01 val loss: 3.97e-01 for "phygnn"
INFO - 2023-04-13 12:17:59,148 [phygnn.py:594] : Epoch 96 train loss: 4.07e-01 val loss: 3.96e-01 for "phygnn"
INFO - 2023-04-13 12:18:08,795 [phygnn.py:594] : Epoch 97 train loss: 4.07e-01 val loss: 3.98e-01 for "phygnn"
INFO - 2023-04-13 12:18:18,436 [phygnn.py:594] : Epoch 98 train loss: 4.07e-01 val loss: 3.96e-01 for "phygnn"
INFO - 2023-04-13 12:18:28,204 [phygnn.py:594] : Epoch 99 train loss: 4.06e-01 val loss: 3.95e-01 for "phygnn"
INFO - 2023-04-13 12:18:28,971 [trainer.py:92] : Training part B - data and phygnn. Loss is [0.5, 0.5]
/projects/pxs/gbuster/nsrdb_env_2023/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
INFO - 2023-04-13 12:18:52,481 [phygnn.py:594] : Epoch 100 train loss: 2.83e-01 val loss: 2.71e-01 for "phygnn"
INFO - 2023-04-13 12:19:08,055 [phygnn.py:594] : Epoch 101 train loss: 2.82e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:19:24,667 [phygnn.py:594] : Epoch 102 train loss: 2.81e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:19:41,522 [phygnn.py:594] : Epoch 103 train loss: 2.81e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:19:58,304 [phygnn.py:594] : Epoch 104 train loss: 2.81e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:20:15,591 [phygnn.py:594] : Epoch 105 train loss: 2.81e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:20:32,575 [phygnn.py:594] : Epoch 106 train loss: 2.81e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:20:49,248 [phygnn.py:594] : Epoch 107 train loss: 2.81e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:21:06,692 [phygnn.py:594] : Epoch 108 train loss: 2.80e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:21:23,999 [phygnn.py:594] : Epoch 109 train loss: 2.81e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:21:41,461 [phygnn.py:594] : Epoch 110 train loss: 2.80e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:21:58,841 [phygnn.py:594] : Epoch 111 train loss: 2.80e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:22:16,009 [phygnn.py:594] : Epoch 112 train loss: 2.80e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:22:32,747 [phygnn.py:594] : Epoch 113 train loss: 2.80e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:22:49,850 [phygnn.py:594] : Epoch 114 train loss: 2.80e-01 val loss: 2.70e-01 for "phygnn"
INFO - 2023-04-13 12:23:06,670 [phygnn.py:594] : Epoch 115 train loss: 2.80e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:23:23,731 [phygnn.py:594] : Epoch 116 train loss: 2.80e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:23:41,111 [phygnn.py:594] : Epoch 117 train loss: 2.80e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:23:57,793 [phygnn.py:594] : Epoch 118 train loss: 2.79e-01 val loss: 2.71e-01 for "phygnn"
INFO - 2023-04-13 12:24:14,845 [phygnn.py:594] : Epoch 119 train loss: 2.79e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:24:32,246 [phygnn.py:594] : Epoch 120 train loss: 2.79e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:24:49,746 [phygnn.py:594] : Epoch 121 train loss: 2.79e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:25:06,912 [phygnn.py:594] : Epoch 122 train loss: 2.79e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:25:23,755 [phygnn.py:594] : Epoch 123 train loss: 2.79e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:25:40,101 [phygnn.py:594] : Epoch 124 train loss: 2.79e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:25:56,843 [phygnn.py:594] : Epoch 125 train loss: 2.78e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:26:13,625 [phygnn.py:594] : Epoch 126 train loss: 2.78e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:26:29,828 [phygnn.py:594] : Epoch 127 train loss: 2.78e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:26:47,161 [phygnn.py:594] : Epoch 128 train loss: 2.78e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:27:04,483 [phygnn.py:594] : Epoch 129 train loss: 2.78e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:27:20,673 [phygnn.py:594] : Epoch 130 train loss: 2.78e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:27:36,854 [phygnn.py:594] : Epoch 131 train loss: 2.78e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:27:53,527 [phygnn.py:594] : Epoch 132 train loss: 2.78e-01 val loss: 2.69e-01 for "phygnn"
INFO - 2023-04-13 12:28:10,724 [phygnn.py:594] : Epoch 133 train loss: 2.77e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:28:28,017 [phygnn.py:594] : Epoch 134 train loss: 2.78e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:28:45,090 [phygnn.py:594] : Epoch 135 train loss: 2.77e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:29:02,291 [phygnn.py:594] : Epoch 136 train loss: 2.77e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:29:18,987 [phygnn.py:594] : Epoch 137 train loss: 2.77e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:29:35,460 [phygnn.py:594] : Epoch 138 train loss: 2.77e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:29:51,669 [phygnn.py:594] : Epoch 139 train loss: 2.77e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:30:08,824 [phygnn.py:594] : Epoch 140 train loss: 2.77e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:30:25,610 [phygnn.py:594] : Epoch 141 train loss: 2.77e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:30:41,894 [phygnn.py:594] : Epoch 142 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:30:58,719 [phygnn.py:594] : Epoch 143 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:31:15,578 [phygnn.py:594] : Epoch 144 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:31:32,883 [phygnn.py:594] : Epoch 145 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:31:49,514 [phygnn.py:594] : Epoch 146 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:32:06,319 [phygnn.py:594] : Epoch 147 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:32:23,887 [phygnn.py:594] : Epoch 148 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:32:41,061 [phygnn.py:594] : Epoch 149 train loss: 2.76e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:32:58,099 [phygnn.py:594] : Epoch 150 train loss: 2.76e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:33:15,258 [phygnn.py:594] : Epoch 151 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:33:32,723 [phygnn.py:594] : Epoch 152 train loss: 2.76e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:33:50,284 [phygnn.py:594] : Epoch 153 train loss: 2.75e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:34:06,948 [phygnn.py:594] : Epoch 154 train loss: 2.75e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:34:23,570 [phygnn.py:594] : Epoch 155 train loss: 2.75e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:34:40,699 [phygnn.py:594] : Epoch 156 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:34:57,148 [phygnn.py:594] : Epoch 157 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:35:13,971 [phygnn.py:594] : Epoch 158 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:35:30,215 [phygnn.py:594] : Epoch 159 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:35:47,113 [phygnn.py:594] : Epoch 160 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:36:04,275 [phygnn.py:594] : Epoch 161 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:36:21,726 [phygnn.py:594] : Epoch 162 train loss: 2.75e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:36:38,268 [phygnn.py:594] : Epoch 163 train loss: 2.74e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:36:54,561 [phygnn.py:594] : Epoch 164 train loss: 2.74e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:37:11,086 [phygnn.py:594] : Epoch 165 train loss: 2.74e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:37:27,394 [phygnn.py:594] : Epoch 166 train loss: 2.74e-01 val loss: 2.68e-01 for "phygnn"
INFO - 2023-04-13 12:37:43,560 [phygnn.py:594] : Epoch 167 train loss: 2.74e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:38:01,042 [phygnn.py:594] : Epoch 168 train loss: 2.74e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:38:17,839 [phygnn.py:594] : Epoch 169 train loss: 2.74e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:38:34,262 [phygnn.py:594] : Epoch 170 train loss: 2.74e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:38:51,623 [phygnn.py:594] : Epoch 171 train loss: 2.73e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:39:08,302 [phygnn.py:594] : Epoch 172 train loss: 2.73e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:39:24,751 [phygnn.py:594] : Epoch 173 train loss: 2.73e-01 val loss: 2.67e-01 for "phygnn"
INFO - 2023-04-13 12:39:41,068 [phygnn.py:594] : Epoch 174 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:39:58,398 [phygnn.py:594] : Epoch 175 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:40:14,995 [phygnn.py:594] : Epoch 176 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:40:31,984 [phygnn.py:594] : Epoch 177 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:40:48,646 [phygnn.py:594] : Epoch 178 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:41:04,923 [phygnn.py:594] : Epoch 179 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:41:22,041 [phygnn.py:594] : Epoch 180 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:41:39,591 [phygnn.py:594] : Epoch 181 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:41:56,863 [phygnn.py:594] : Epoch 182 train loss: 2.72e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:42:14,149 [phygnn.py:594] : Epoch 183 train loss: 2.73e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:42:30,918 [phygnn.py:594] : Epoch 184 train loss: 2.72e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:42:47,676 [phygnn.py:594] : Epoch 185 train loss: 2.72e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:43:04,515 [phygnn.py:594] : Epoch 186 train loss: 2.72e-01 val loss: 2.65e-01 for "phygnn"
INFO - 2023-04-13 12:43:21,140 [phygnn.py:594] : Epoch 187 train loss: 2.72e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:43:37,501 [phygnn.py:594] : Epoch 188 train loss: 2.72e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:43:54,990 [phygnn.py:594] : Epoch 189 train loss: 2.72e-01 val loss: 2.66e-01 for "phygnn"
INFO - 2023-04-13 12:43:55,605 [trainer.py:102] : Training complete
INFO - 2023-04-13 12:43:55,642 [base.py:469] : Saved model to: /home/gbuster/code/mlclouds/mlclouds/model/production_model/outputs/mlclouds_model.pkl
Validating on 630893 out of 3154464 observations
DEBUG - 2023-04-13 12:43:57,289 [data_handlers.py:391] : Loading validation data
DEBUG - 2023-04-13 12:43:57,289 [data_handlers.py:397] : Loading vars ['solar_zenith_angle', 'cloud_type', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'cld_opd_dcomp', 'cld_reff_dcomp']
DEBUG - 2023-04-13 12:43:57,314 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2016_east_v322/mlclouds_surfrad_east_2016.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:43:59,177 [data_handlers.py:421] : 	Shape temp_raw=(158112, 19), temp_all_sky=(158112, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:43:59,177 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2016_west_v322/mlclouds_surfrad_west_2016.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:44:01,007 [data_handlers.py:421] : 	Shape temp_raw=(158112, 19), temp_all_sky=(158112, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:44:01,007 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2017_east_v322/mlclouds_surfrad_east_2017.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:44:02,787 [data_handlers.py:421] : 	Shape temp_raw=(157680, 19), temp_all_sky=(157680, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:44:02,788 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2017_west_v322/mlclouds_surfrad_west_2017.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:44:04,540 [data_handlers.py:421] : 	Shape temp_raw=(157680, 19), temp_all_sky=(157680, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:44:04,540 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2018_east_v322/mlclouds_surfrad_east_2018.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:44:16,740 [data_handlers.py:421] : 	Shape temp_raw=(946080, 19), temp_all_sky=(946080, 14), & tstep=5 minutes
DEBUG - 2023-04-13 12:44:16,741 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2018_west_v322/mlclouds_surfrad_west_2018.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:44:18,561 [data_handlers.py:421] : 	Shape temp_raw=(157680, 19), temp_all_sky=(157680, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:44:18,561 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2019_east_v322/mlclouds_surfrad_east_2019.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:44:30,946 [data_handlers.py:421] : 	Shape temp_raw=(946080, 19), temp_all_sky=(946080, 14), & tstep=5 minutes
DEBUG - 2023-04-13 12:44:30,947 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2019_west_v322/mlclouds_surfrad_west_2019.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:44:36,850 [data_handlers.py:421] : 	Shape temp_raw=(473040, 19), temp_all_sky=(473040, 14), & tstep=10 minutes
DEBUG - 2023-04-13 12:44:36,850 [data_handlers.py:424] : Shape df_raw=(3154464, 19), df_all_sky=(3154464, 14)
DEBUG - 2023-04-13 12:44:36,850 [data_handlers.py:431] : Shape after reset_index: df_raw=(3154464, 19), df_all_sky=(3154464, 14)
DEBUG - 2023-04-13 12:44:36,978 [data_handlers.py:441] : Test set shape: df_raw=(630893, 19), df_all_sky=(630893, 14)
INFO - 2023-04-13 12:44:37,087 [data_cleaners.py:36] : 49.68% of timesteps are daylight
INFO - 2023-04-13 12:44:37,088 [data_cleaners.py:38] : 52.16% of daylight timesteps are cloudy
INFO - 2023-04-13 12:44:37,088 [data_cleaners.py:40] : 3.22% of daylight timesteps are missing cloud type
INFO - 2023-04-13 12:44:37,089 [data_cleaners.py:42] : 33.92% of cloudy daylight timesteps are missing cloud opd
INFO - 2023-04-13 12:44:37,090 [data_cleaners.py:44] : 34.13% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2023-04-13 12:44:37,090 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2023-04-13 12:44:37,090 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,092 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,093 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,094 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,095 [data_cleaners.py:50] : 	"refl_0_65um_nom" has 51.43% NaN values
DEBUG - 2023-04-13 12:44:37,096 [data_cleaners.py:50] : 	"refl_0_65um_nom_stddev_3x3" has 51.43% NaN values
DEBUG - 2023-04-13 12:44:37,097 [data_cleaners.py:50] : 	"refl_3_75um_nom" has 3.26% NaN values
DEBUG - 2023-04-13 12:44:37,097 [data_cleaners.py:50] : 	"temp_3_75um_nom" has 3.17% NaN values
DEBUG - 2023-04-13 12:44:37,098 [data_cleaners.py:50] : 	"temp_11_0um_nom" has 3.17% NaN values
DEBUG - 2023-04-13 12:44:37,099 [data_cleaners.py:50] : 	"temp_11_0um_nom_stddev_3x3" has 3.25% NaN values
DEBUG - 2023-04-13 12:44:37,100 [data_cleaners.py:50] : 	"cloud_probability" has 3.25% NaN values
DEBUG - 2023-04-13 12:44:37,101 [data_cleaners.py:50] : 	"cloud_fraction" has 3.25% NaN values
DEBUG - 2023-04-13 12:44:37,102 [data_cleaners.py:50] : 	"air_temperature" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,103 [data_cleaners.py:50] : 	"dew_point" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,104 [data_cleaners.py:50] : 	"relative_humidity" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,105 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,106 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,106 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 82.88% NaN values
DEBUG - 2023-04-13 12:44:37,107 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 82.93% NaN values
DEBUG - 2023-04-13 12:44:37,107 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2023-04-13 12:44:37,599 [data_cleaners.py:79] : Adding cloud type flag (e.g. flag=[night, clear, ice_cloud, water_cloud, bad_cloud])
DEBUG - 2023-04-13 12:44:37,731 [data_cleaners.py:105] : Feature flag column has these values: ['water_cloud' 'night' 'bad_cloud' 'ice_cloud' 'clear']
INFO - 2023-04-13 12:44:37,731 [data_cleaners.py:107] : Cleaning took 0.8 seconds
INFO - 2023-04-13 12:44:37,825 [data_cleaners.py:36] : 49.68% of timesteps are daylight
INFO - 2023-04-13 12:44:37,826 [data_cleaners.py:38] : 52.16% of daylight timesteps are cloudy
INFO - 2023-04-13 12:44:37,827 [data_cleaners.py:40] : 3.22% of daylight timesteps are missing cloud type
INFO - 2023-04-13 12:44:37,827 [data_cleaners.py:42] : 33.92% of cloudy daylight timesteps are missing cloud opd
INFO - 2023-04-13 12:44:37,828 [data_cleaners.py:44] : 34.13% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2023-04-13 12:44:37,828 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2023-04-13 12:44:37,829 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,830 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,831 [data_cleaners.py:50] : 	"alpha" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,832 [data_cleaners.py:50] : 	"aod" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,832 [data_cleaners.py:50] : 	"asymmetry" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,834 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,834 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 82.88% NaN values
DEBUG - 2023-04-13 12:44:37,835 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 82.93% NaN values
DEBUG - 2023-04-13 12:44:37,836 [data_cleaners.py:50] : 	"ozone" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,837 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,838 [data_cleaners.py:50] : 	"ssa" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,838 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,839 [data_cleaners.py:50] : 	"surface_pressure" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,840 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2023-04-13 12:44:37,840 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2023-04-13 12:44:38,096 [data_cleaners.py:79] : Adding cloud type flag (e.g. flag=[night, clear, ice_cloud, water_cloud, bad_cloud])
DEBUG - 2023-04-13 12:44:38,227 [data_cleaners.py:105] : Feature flag column has these values: ['water_cloud' 'night' 'bad_cloud' 'ice_cloud' 'clear']
INFO - 2023-04-13 12:44:38,227 [data_cleaners.py:107] : Cleaning took 0.5 seconds
DEBUG - 2023-04-13 12:44:38,227 [data_handlers.py:464] : Prepping validation data
DEBUG - 2023-04-13 12:44:38,269 [data_handlers.py:474] : Mask: shape=(630893,), sum=313437
DEBUG - 2023-04-13 12:44:38,296 [data_handlers.py:485] : Validation features: ['solar_zenith_angle', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'flag']
INFO - 2023-04-13 12:44:38,296 [validator.py:107] : Predicting opd and reff
/projects/pxs/gbuster/nsrdb_env_2023/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
DEBUG - 2023-04-13 12:44:39,013 [validator.py:110] : Predicted data shape is (313437, 2)
DEBUG - 2023-04-13 12:44:39,091 [validator.py:158] : shapes: df_feature_val=(630893, 20), df_all_sky_val=(630893, 15)
INFO - 2023-04-13 12:44:39,143 [validator.py:179] : Calculating statistics
DEBUG - 2023-04-13 12:44:39,146 [validator.py:182] : Calcing stats for gids: [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:44:39,146 [validator.py:339] : Loading data for 2016 / east
DEBUG - 2023-04-13 12:44:39,146 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:44:39,479 [validator.py:377] : 	Getting surfrad data for 0 from bon_2016.h5
DEBUG - 2023-04-13 12:44:40,230 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:44:40,262 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2016.h5
DEBUG - 2023-04-13 12:44:40,988 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:44:41,022 [validator.py:377] : 	Getting surfrad data for 2 from dra_2016.h5
DEBUG - 2023-04-13 12:44:41,749 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:44:41,784 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2016.h5
DEBUG - 2023-04-13 12:44:42,508 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:44:42,543 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2016.h5
DEBUG - 2023-04-13 12:44:43,263 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:44:43,298 [validator.py:377] : 	Getting surfrad data for 5 from psu_2016.h5
DEBUG - 2023-04-13 12:44:44,027 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:44:44,061 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2016.h5
DEBUG - 2023-04-13 12:44:44,784 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:44:44,818 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2016.h5
DEBUG - 2023-04-13 12:44:45,539 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:44:45,572 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2016.h5
DEBUG - 2023-04-13 12:44:46,325 [validator.py:339] : Loading data for 2016 / west
DEBUG - 2023-04-13 12:44:46,325 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:44:46,773 [validator.py:377] : 	Getting surfrad data for 0 from bon_2016.h5
DEBUG - 2023-04-13 12:44:47,433 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:44:47,466 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2016.h5
DEBUG - 2023-04-13 12:44:48,133 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:44:48,166 [validator.py:377] : 	Getting surfrad data for 2 from dra_2016.h5
DEBUG - 2023-04-13 12:44:48,833 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:44:48,866 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2016.h5
DEBUG - 2023-04-13 12:44:49,529 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:44:49,564 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2016.h5
DEBUG - 2023-04-13 12:44:50,233 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:44:50,267 [validator.py:377] : 	Getting surfrad data for 5 from psu_2016.h5
DEBUG - 2023-04-13 12:44:50,929 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:44:50,962 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2016.h5
DEBUG - 2023-04-13 12:44:51,622 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:44:51,655 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2016.h5
DEBUG - 2023-04-13 12:44:52,318 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:44:52,350 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2016.h5
DEBUG - 2023-04-13 12:44:53,016 [validator.py:339] : Loading data for 2017 / east
DEBUG - 2023-04-13 12:44:53,017 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:44:53,470 [validator.py:377] : 	Getting surfrad data for 0 from bon_2017.h5
DEBUG - 2023-04-13 12:44:54,220 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:44:54,254 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2017.h5
DEBUG - 2023-04-13 12:44:54,984 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:44:55,018 [validator.py:377] : 	Getting surfrad data for 2 from dra_2017.h5
DEBUG - 2023-04-13 12:44:55,737 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:44:55,770 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2017.h5
DEBUG - 2023-04-13 12:44:56,493 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:44:56,525 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2017.h5
DEBUG - 2023-04-13 12:44:57,247 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:44:57,279 [validator.py:377] : 	Getting surfrad data for 5 from psu_2017.h5
DEBUG - 2023-04-13 12:44:57,998 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:44:58,030 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2017.h5
DEBUG - 2023-04-13 12:44:58,758 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:44:58,790 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2017.h5
DEBUG - 2023-04-13 12:44:59,498 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:44:59,531 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2017.h5
DEBUG - 2023-04-13 12:45:00,290 [validator.py:339] : Loading data for 2017 / west
DEBUG - 2023-04-13 12:45:00,290 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:45:00,786 [validator.py:377] : 	Getting surfrad data for 0 from bon_2017.h5
DEBUG - 2023-04-13 12:45:01,455 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:45:01,487 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2017.h5
DEBUG - 2023-04-13 12:45:02,158 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:45:02,191 [validator.py:377] : 	Getting surfrad data for 2 from dra_2017.h5
DEBUG - 2023-04-13 12:45:02,856 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:45:02,888 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2017.h5
DEBUG - 2023-04-13 12:45:03,557 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:45:03,590 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2017.h5
DEBUG - 2023-04-13 12:45:04,261 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:45:04,293 [validator.py:377] : 	Getting surfrad data for 5 from psu_2017.h5
DEBUG - 2023-04-13 12:45:04,961 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:45:04,994 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2017.h5
DEBUG - 2023-04-13 12:45:05,661 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:45:05,694 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2017.h5
DEBUG - 2023-04-13 12:45:06,361 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:45:06,394 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2017.h5
DEBUG - 2023-04-13 12:45:07,069 [validator.py:339] : Loading data for 2018 / east
DEBUG - 2023-04-13 12:45:07,069 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:45:07,416 [validator.py:377] : 	Getting surfrad data for 0 from bon_2018.h5
DEBUG - 2023-04-13 12:45:08,154 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:45:08,229 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2018.h5
DEBUG - 2023-04-13 12:45:08,974 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:45:09,048 [validator.py:377] : 	Getting surfrad data for 2 from dra_2018.h5
DEBUG - 2023-04-13 12:45:09,786 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:45:09,859 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2018.h5
DEBUG - 2023-04-13 12:45:10,597 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:45:10,671 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2018.h5
DEBUG - 2023-04-13 12:45:11,418 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:45:11,495 [validator.py:377] : 	Getting surfrad data for 5 from psu_2018.h5
DEBUG - 2023-04-13 12:45:12,235 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:45:12,310 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2018.h5
DEBUG - 2023-04-13 12:45:13,058 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:45:13,133 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2018.h5
DEBUG - 2023-04-13 12:45:13,879 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:45:13,953 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2018.h5
DEBUG - 2023-04-13 12:45:14,738 [validator.py:339] : Loading data for 2018 / west
DEBUG - 2023-04-13 12:45:14,738 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:45:14,784 [validator.py:377] : 	Getting surfrad data for 0 from bon_2018.h5
DEBUG - 2023-04-13 12:45:15,472 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:45:15,505 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2018.h5
DEBUG - 2023-04-13 12:45:16,193 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:45:16,226 [validator.py:377] : 	Getting surfrad data for 2 from dra_2018.h5
DEBUG - 2023-04-13 12:45:16,916 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:45:16,951 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2018.h5
DEBUG - 2023-04-13 12:45:17,636 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:45:17,670 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2018.h5
DEBUG - 2023-04-13 12:45:18,359 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:45:18,393 [validator.py:377] : 	Getting surfrad data for 5 from psu_2018.h5
DEBUG - 2023-04-13 12:45:19,082 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:45:19,116 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2018.h5
DEBUG - 2023-04-13 12:45:19,801 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:45:19,836 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2018.h5
DEBUG - 2023-04-13 12:45:20,520 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:45:20,555 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2018.h5
DEBUG - 2023-04-13 12:45:21,245 [validator.py:339] : Loading data for 2019 / east
DEBUG - 2023-04-13 12:45:21,245 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:45:21,540 [validator.py:377] : 	Getting surfrad data for 0 from bon_2019.h5
DEBUG - 2023-04-13 12:45:22,302 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:45:22,379 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2019.h5
DEBUG - 2023-04-13 12:45:23,141 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:45:23,218 [validator.py:377] : 	Getting surfrad data for 2 from dra_2019.h5
DEBUG - 2023-04-13 12:45:23,982 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:45:24,060 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2019.h5
DEBUG - 2023-04-13 12:45:24,835 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:45:24,912 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2019.h5
DEBUG - 2023-04-13 12:45:25,673 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:45:25,750 [validator.py:377] : 	Getting surfrad data for 5 from psu_2019.h5
DEBUG - 2023-04-13 12:45:26,515 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:45:26,594 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2019.h5
DEBUG - 2023-04-13 12:45:27,342 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:45:27,418 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2019.h5
DEBUG - 2023-04-13 12:45:28,170 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:45:28,247 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2019.h5
DEBUG - 2023-04-13 12:45:29,043 [validator.py:339] : Loading data for 2019 / west
DEBUG - 2023-04-13 12:45:29,043 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:45:29,186 [validator.py:377] : 	Getting surfrad data for 0 from bon_2019.h5
DEBUG - 2023-04-13 12:45:29,911 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:45:29,962 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2019.h5
DEBUG - 2023-04-13 12:45:30,673 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:45:30,724 [validator.py:377] : 	Getting surfrad data for 2 from dra_2019.h5
DEBUG - 2023-04-13 12:45:31,447 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:45:31,498 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2019.h5
DEBUG - 2023-04-13 12:45:32,221 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:45:32,272 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2019.h5
DEBUG - 2023-04-13 12:45:32,992 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:45:33,044 [validator.py:377] : 	Getting surfrad data for 5 from psu_2019.h5
DEBUG - 2023-04-13 12:45:33,756 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:45:33,807 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2019.h5
DEBUG - 2023-04-13 12:45:34,530 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:45:34,581 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2019.h5
DEBUG - 2023-04-13 12:45:35,303 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:45:35,355 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2019.h5
DEBUG - 2023-04-13 12:45:36,096 [validator.py:187] : Shapes: df_base_full=(3154464, 6), df_surf_full=(3154464, 4)
DEBUG - 2023-04-13 12:45:36,154 [validator.py:194] : Test set shapes: df_base_full=(630893, 6), df_surf_full=(630893, 4)
DEBUG - 2023-04-13 12:45:36,158 [validator.py:203] : Computing stats for gid: 0 bon
DEBUG - 2023-04-13 12:45:36,166 [validator.py:209] : Shapes: df_baseline=(70126, 6), df_surf=(70126, 4)
DEBUG - 2023-04-13 12:45:41,058 [validator.py:203] : Computing stats for gid: 1 tbl
DEBUG - 2023-04-13 12:45:41,066 [validator.py:209] : Shapes: df_baseline=(70295, 6), df_surf=(70295, 4)
DEBUG - 2023-04-13 12:45:45,897 [validator.py:203] : Computing stats for gid: 2 dra
DEBUG - 2023-04-13 12:45:45,905 [validator.py:209] : Shapes: df_baseline=(70062, 6), df_surf=(70062, 4)
DEBUG - 2023-04-13 12:45:50,719 [validator.py:203] : Computing stats for gid: 3 fpk
DEBUG - 2023-04-13 12:45:50,727 [validator.py:209] : Shapes: df_baseline=(70216, 6), df_surf=(70216, 4)
DEBUG - 2023-04-13 12:45:55,570 [validator.py:203] : Computing stats for gid: 4 gwn
DEBUG - 2023-04-13 12:45:55,578 [validator.py:209] : Shapes: df_baseline=(70196, 6), df_surf=(70196, 4)
DEBUG - 2023-04-13 12:46:00,423 [validator.py:203] : Computing stats for gid: 5 psu
DEBUG - 2023-04-13 12:46:00,431 [validator.py:209] : Shapes: df_baseline=(70109, 6), df_surf=(70109, 4)
DEBUG - 2023-04-13 12:46:05,273 [validator.py:203] : Computing stats for gid: 6 sxf
DEBUG - 2023-04-13 12:46:05,281 [validator.py:209] : Shapes: df_baseline=(69998, 6), df_surf=(69998, 4)
DEBUG - 2023-04-13 12:46:10,109 [validator.py:203] : Computing stats for gid: 7 sgp
DEBUG - 2023-04-13 12:46:10,117 [validator.py:209] : Shapes: df_baseline=(69862, 6), df_surf=(69862, 4)
DEBUG - 2023-04-13 12:46:14,942 [validator.py:203] : Computing stats for gid: 8 srrl
DEBUG - 2023-04-13 12:46:14,950 [validator.py:209] : Shapes: df_baseline=(70029, 6), df_surf=(70029, 4)
INFO - 2023-04-13 12:46:19,781 [validator.py:285] : Finished computing stats.
Validating on 441941 out of 2207952 observations
DEBUG - 2023-04-13 12:46:20,517 [data_handlers.py:391] : Loading validation data
DEBUG - 2023-04-13 12:46:20,517 [data_handlers.py:397] : Loading vars ['solar_zenith_angle', 'cloud_type', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'cld_opd_dcomp', 'cld_reff_dcomp']
DEBUG - 2023-04-13 12:46:20,520 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2016_east_v322/mlclouds_surfrad_east_2016.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:46:22,382 [data_handlers.py:421] : 	Shape temp_raw=(158112, 19), temp_all_sky=(158112, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:46:22,382 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2017_east_v322/mlclouds_surfrad_east_2017.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:46:24,280 [data_handlers.py:421] : 	Shape temp_raw=(157680, 19), temp_all_sky=(157680, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:46:24,281 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2018_east_v322/mlclouds_surfrad_east_2018.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:46:36,698 [data_handlers.py:421] : 	Shape temp_raw=(946080, 19), temp_all_sky=(946080, 14), & tstep=5 minutes
DEBUG - 2023-04-13 12:46:36,698 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2019_east_v322/mlclouds_surfrad_east_2019.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:46:49,151 [data_handlers.py:421] : 	Shape temp_raw=(946080, 19), temp_all_sky=(946080, 14), & tstep=5 minutes
DEBUG - 2023-04-13 12:46:49,152 [data_handlers.py:424] : Shape df_raw=(2207952, 19), df_all_sky=(2207952, 14)
DEBUG - 2023-04-13 12:46:49,152 [data_handlers.py:431] : Shape after reset_index: df_raw=(2207952, 19), df_all_sky=(2207952, 14)
DEBUG - 2023-04-13 12:46:49,242 [data_handlers.py:441] : Test set shape: df_raw=(441941, 19), df_all_sky=(441941, 14)
INFO - 2023-04-13 12:46:49,312 [data_cleaners.py:36] : 49.69% of timesteps are daylight
INFO - 2023-04-13 12:46:49,312 [data_cleaners.py:38] : 50.80% of daylight timesteps are cloudy
INFO - 2023-04-13 12:46:49,313 [data_cleaners.py:40] : 0.33% of daylight timesteps are missing cloud type
INFO - 2023-04-13 12:46:49,313 [data_cleaners.py:42] : 26.84% of cloudy daylight timesteps are missing cloud opd
INFO - 2023-04-13 12:46:49,314 [data_cleaners.py:44] : 27.10% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2023-04-13 12:46:49,314 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2023-04-13 12:46:49,314 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,315 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,316 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,317 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,317 [data_cleaners.py:50] : 	"refl_0_65um_nom" has 49.99% NaN values
DEBUG - 2023-04-13 12:46:49,318 [data_cleaners.py:50] : 	"refl_0_65um_nom_stddev_3x3" has 49.99% NaN values
DEBUG - 2023-04-13 12:46:49,319 [data_cleaners.py:50] : 	"refl_3_75um_nom" has 0.34% NaN values
DEBUG - 2023-04-13 12:46:49,319 [data_cleaners.py:50] : 	"temp_3_75um_nom" has 0.26% NaN values
DEBUG - 2023-04-13 12:46:49,320 [data_cleaners.py:50] : 	"temp_11_0um_nom" has 0.26% NaN values
DEBUG - 2023-04-13 12:46:49,321 [data_cleaners.py:50] : 	"temp_11_0um_nom_stddev_3x3" has 0.33% NaN values
DEBUG - 2023-04-13 12:46:49,321 [data_cleaners.py:50] : 	"cloud_probability" has 0.33% NaN values
DEBUG - 2023-04-13 12:46:49,322 [data_cleaners.py:50] : 	"cloud_fraction" has 0.33% NaN values
DEBUG - 2023-04-13 12:46:49,323 [data_cleaners.py:50] : 	"air_temperature" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,323 [data_cleaners.py:50] : 	"dew_point" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,324 [data_cleaners.py:50] : 	"relative_humidity" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,325 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,325 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,326 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 81.53% NaN values
DEBUG - 2023-04-13 12:46:49,326 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 81.60% NaN values
DEBUG - 2023-04-13 12:46:49,326 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2023-04-13 12:46:49,638 [data_cleaners.py:79] : Adding cloud type flag (e.g. flag=[night, clear, ice_cloud, water_cloud, bad_cloud])
DEBUG - 2023-04-13 12:46:49,726 [data_cleaners.py:105] : Feature flag column has these values: ['water_cloud' 'night' 'bad_cloud' 'ice_cloud' 'clear']
INFO - 2023-04-13 12:46:49,726 [data_cleaners.py:107] : Cleaning took 0.5 seconds
INFO - 2023-04-13 12:46:49,790 [data_cleaners.py:36] : 49.69% of timesteps are daylight
INFO - 2023-04-13 12:46:49,790 [data_cleaners.py:38] : 50.80% of daylight timesteps are cloudy
INFO - 2023-04-13 12:46:49,791 [data_cleaners.py:40] : 0.33% of daylight timesteps are missing cloud type
INFO - 2023-04-13 12:46:49,791 [data_cleaners.py:42] : 26.84% of cloudy daylight timesteps are missing cloud opd
INFO - 2023-04-13 12:46:49,792 [data_cleaners.py:44] : 27.10% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2023-04-13 12:46:49,792 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2023-04-13 12:46:49,792 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,793 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,794 [data_cleaners.py:50] : 	"alpha" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,795 [data_cleaners.py:50] : 	"aod" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,795 [data_cleaners.py:50] : 	"asymmetry" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,796 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,797 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 81.53% NaN values
DEBUG - 2023-04-13 12:46:49,798 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 81.60% NaN values
DEBUG - 2023-04-13 12:46:49,798 [data_cleaners.py:50] : 	"ozone" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,799 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,799 [data_cleaners.py:50] : 	"ssa" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,800 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,801 [data_cleaners.py:50] : 	"surface_pressure" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,801 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2023-04-13 12:46:49,801 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2023-04-13 12:46:49,987 [data_cleaners.py:79] : Adding cloud type flag (e.g. flag=[night, clear, ice_cloud, water_cloud, bad_cloud])
DEBUG - 2023-04-13 12:46:50,074 [data_cleaners.py:105] : Feature flag column has these values: ['water_cloud' 'night' 'bad_cloud' 'ice_cloud' 'clear']
INFO - 2023-04-13 12:46:50,074 [data_cleaners.py:107] : Cleaning took 0.3 seconds
DEBUG - 2023-04-13 12:46:50,074 [data_handlers.py:464] : Prepping validation data
DEBUG - 2023-04-13 12:46:50,102 [data_handlers.py:474] : Mask: shape=(441941,), sum=219586
DEBUG - 2023-04-13 12:46:50,120 [data_handlers.py:485] : Validation features: ['solar_zenith_angle', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'flag']
INFO - 2023-04-13 12:46:50,121 [validator.py:107] : Predicting opd and reff
/projects/pxs/gbuster/nsrdb_env_2023/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
DEBUG - 2023-04-13 12:46:50,662 [validator.py:110] : Predicted data shape is (219586, 2)
DEBUG - 2023-04-13 12:46:50,715 [validator.py:158] : shapes: df_feature_val=(441941, 20), df_all_sky_val=(441941, 15)
INFO - 2023-04-13 12:46:50,752 [validator.py:179] : Calculating statistics
DEBUG - 2023-04-13 12:46:50,759 [validator.py:182] : Calcing stats for gids: [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:46:50,759 [validator.py:339] : Loading data for 2016 / east
DEBUG - 2023-04-13 12:46:50,759 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:46:50,793 [validator.py:377] : 	Getting surfrad data for 0 from bon_2016.h5
DEBUG - 2023-04-13 12:46:51,453 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:46:51,488 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2016.h5
DEBUG - 2023-04-13 12:46:52,154 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:46:52,191 [validator.py:377] : 	Getting surfrad data for 2 from dra_2016.h5
DEBUG - 2023-04-13 12:46:52,859 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:46:52,894 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2016.h5
DEBUG - 2023-04-13 12:46:53,558 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:46:53,593 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2016.h5
DEBUG - 2023-04-13 12:46:54,256 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:46:54,293 [validator.py:377] : 	Getting surfrad data for 5 from psu_2016.h5
DEBUG - 2023-04-13 12:46:54,961 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:46:54,997 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2016.h5
DEBUG - 2023-04-13 12:46:55,660 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:46:55,696 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2016.h5
DEBUG - 2023-04-13 12:46:56,356 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:46:56,390 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2016.h5
DEBUG - 2023-04-13 12:46:57,047 [validator.py:339] : Loading data for 2017 / east
DEBUG - 2023-04-13 12:46:57,047 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:46:57,082 [validator.py:377] : 	Getting surfrad data for 0 from bon_2017.h5
DEBUG - 2023-04-13 12:46:57,754 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:46:57,787 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2017.h5
DEBUG - 2023-04-13 12:46:58,457 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:46:58,491 [validator.py:377] : 	Getting surfrad data for 2 from dra_2017.h5
DEBUG - 2023-04-13 12:46:59,162 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:46:59,196 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2017.h5
DEBUG - 2023-04-13 12:46:59,865 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:46:59,901 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2017.h5
DEBUG - 2023-04-13 12:47:00,577 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:47:00,611 [validator.py:377] : 	Getting surfrad data for 5 from psu_2017.h5
DEBUG - 2023-04-13 12:47:01,276 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:47:01,310 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2017.h5
DEBUG - 2023-04-13 12:47:01,978 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:47:02,014 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2017.h5
DEBUG - 2023-04-13 12:47:02,681 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:47:02,715 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2017.h5
DEBUG - 2023-04-13 12:47:03,387 [validator.py:339] : Loading data for 2018 / east
DEBUG - 2023-04-13 12:47:03,387 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:47:03,462 [validator.py:377] : 	Getting surfrad data for 0 from bon_2018.h5
DEBUG - 2023-04-13 12:47:04,150 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:47:04,226 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2018.h5
DEBUG - 2023-04-13 12:47:04,915 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:47:04,991 [validator.py:377] : 	Getting surfrad data for 2 from dra_2018.h5
DEBUG - 2023-04-13 12:47:05,679 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:47:05,755 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2018.h5
DEBUG - 2023-04-13 12:47:06,446 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:47:06,523 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2018.h5
DEBUG - 2023-04-13 12:47:07,209 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:47:07,285 [validator.py:377] : 	Getting surfrad data for 5 from psu_2018.h5
DEBUG - 2023-04-13 12:47:07,972 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:47:08,049 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2018.h5
DEBUG - 2023-04-13 12:47:08,742 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:47:08,819 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2018.h5
DEBUG - 2023-04-13 12:47:09,504 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:47:09,580 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2018.h5
DEBUG - 2023-04-13 12:47:10,276 [validator.py:339] : Loading data for 2019 / east
DEBUG - 2023-04-13 12:47:10,276 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:47:10,353 [validator.py:377] : 	Getting surfrad data for 0 from bon_2019.h5
DEBUG - 2023-04-13 12:47:11,042 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:47:11,118 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2019.h5
DEBUG - 2023-04-13 12:47:11,809 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:47:11,884 [validator.py:377] : 	Getting surfrad data for 2 from dra_2019.h5
DEBUG - 2023-04-13 12:47:12,581 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:47:12,658 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2019.h5
DEBUG - 2023-04-13 12:47:13,352 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:47:13,428 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2019.h5
DEBUG - 2023-04-13 12:47:14,124 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:47:14,200 [validator.py:377] : 	Getting surfrad data for 5 from psu_2019.h5
DEBUG - 2023-04-13 12:47:14,893 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:47:14,968 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2019.h5
DEBUG - 2023-04-13 12:47:15,665 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:47:15,741 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2019.h5
DEBUG - 2023-04-13 12:47:16,441 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:47:16,517 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2019.h5
DEBUG - 2023-04-13 12:47:17,239 [validator.py:187] : Shapes: df_base_full=(2207952, 6), df_surf_full=(2207952, 4)
DEBUG - 2023-04-13 12:47:17,280 [validator.py:194] : Test set shapes: df_base_full=(441941, 6), df_surf_full=(441941, 4)
DEBUG - 2023-04-13 12:47:17,284 [validator.py:203] : Computing stats for gid: 0 bon
DEBUG - 2023-04-13 12:47:17,289 [validator.py:209] : Shapes: df_baseline=(48999, 6), df_surf=(48999, 4)
DEBUG - 2023-04-13 12:47:21,234 [validator.py:203] : Computing stats for gid: 1 tbl
DEBUG - 2023-04-13 12:47:21,240 [validator.py:209] : Shapes: df_baseline=(49331, 6), df_surf=(49331, 4)
DEBUG - 2023-04-13 12:47:25,171 [validator.py:203] : Computing stats for gid: 2 dra
DEBUG - 2023-04-13 12:47:25,177 [validator.py:209] : Shapes: df_baseline=(49184, 6), df_surf=(49184, 4)
DEBUG - 2023-04-13 12:47:29,093 [validator.py:203] : Computing stats for gid: 3 fpk
DEBUG - 2023-04-13 12:47:29,099 [validator.py:209] : Shapes: df_baseline=(49164, 6), df_surf=(49164, 4)
DEBUG - 2023-04-13 12:47:33,029 [validator.py:203] : Computing stats for gid: 4 gwn
DEBUG - 2023-04-13 12:47:33,035 [validator.py:209] : Shapes: df_baseline=(49354, 6), df_surf=(49354, 4)
DEBUG - 2023-04-13 12:47:36,982 [validator.py:203] : Computing stats for gid: 5 psu
DEBUG - 2023-04-13 12:47:36,988 [validator.py:209] : Shapes: df_baseline=(49208, 6), df_surf=(49208, 4)
DEBUG - 2023-04-13 12:47:40,924 [validator.py:203] : Computing stats for gid: 6 sxf
DEBUG - 2023-04-13 12:47:40,930 [validator.py:209] : Shapes: df_baseline=(48837, 6), df_surf=(48837, 4)
DEBUG - 2023-04-13 12:47:44,857 [validator.py:203] : Computing stats for gid: 7 sgp
DEBUG - 2023-04-13 12:47:44,863 [validator.py:209] : Shapes: df_baseline=(48932, 6), df_surf=(48932, 4)
DEBUG - 2023-04-13 12:47:48,789 [validator.py:203] : Computing stats for gid: 8 srrl
DEBUG - 2023-04-13 12:47:48,795 [validator.py:209] : Shapes: df_baseline=(48932, 6), df_surf=(48932, 4)
INFO - 2023-04-13 12:47:52,721 [validator.py:285] : Finished computing stats.
Validating on 188952 out of 946512 observations
DEBUG - 2023-04-13 12:47:53,373 [data_handlers.py:391] : Loading validation data
DEBUG - 2023-04-13 12:47:53,374 [data_handlers.py:397] : Loading vars ['solar_zenith_angle', 'cloud_type', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'cld_opd_dcomp', 'cld_reff_dcomp']
DEBUG - 2023-04-13 12:47:53,377 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2016_west_v322/mlclouds_surfrad_west_2016.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:47:55,232 [data_handlers.py:421] : 	Shape temp_raw=(158112, 19), temp_all_sky=(158112, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:47:55,232 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2017_west_v322/mlclouds_surfrad_west_2017.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:47:57,095 [data_handlers.py:421] : 	Shape temp_raw=(157680, 19), temp_all_sky=(157680, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:47:57,095 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2018_west_v322/mlclouds_surfrad_west_2018.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:47:58,957 [data_handlers.py:421] : 	Shape temp_raw=(157680, 19), temp_all_sky=(157680, 14), & tstep=30 minutes
DEBUG - 2023-04-13 12:47:58,958 [data_handlers.py:402] : Loading validation data from /projects/pxs/mlclouds/training_data/2019_west_v322/mlclouds_surfrad_west_2019.h5 for gids [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:48:04,783 [data_handlers.py:421] : 	Shape temp_raw=(473040, 19), temp_all_sky=(473040, 14), & tstep=10 minutes
DEBUG - 2023-04-13 12:48:04,784 [data_handlers.py:424] : Shape df_raw=(946512, 19), df_all_sky=(946512, 14)
DEBUG - 2023-04-13 12:48:04,784 [data_handlers.py:431] : Shape after reset_index: df_raw=(946512, 19), df_all_sky=(946512, 14)
DEBUG - 2023-04-13 12:48:04,824 [data_handlers.py:441] : Test set shape: df_raw=(188952, 19), df_all_sky=(188952, 14)
INFO - 2023-04-13 12:48:04,856 [data_cleaners.py:36] : 49.67% of timesteps are daylight
INFO - 2023-04-13 12:48:04,857 [data_cleaners.py:38] : 55.35% of daylight timesteps are cloudy
INFO - 2023-04-13 12:48:04,857 [data_cleaners.py:40] : 10.00% of daylight timesteps are missing cloud type
INFO - 2023-04-13 12:48:04,857 [data_cleaners.py:42] : 49.12% of cloudy daylight timesteps are missing cloud opd
INFO - 2023-04-13 12:48:04,858 [data_cleaners.py:44] : 49.24% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2023-04-13 12:48:04,858 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2023-04-13 12:48:04,858 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:04,858 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:04,859 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:04,859 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:04,860 [data_cleaners.py:50] : 	"refl_0_65um_nom" has 54.80% NaN values
DEBUG - 2023-04-13 12:48:04,860 [data_cleaners.py:50] : 	"refl_0_65um_nom_stddev_3x3" has 54.80% NaN values
DEBUG - 2023-04-13 12:48:04,861 [data_cleaners.py:50] : 	"refl_3_75um_nom" has 10.10% NaN values
DEBUG - 2023-04-13 12:48:04,861 [data_cleaners.py:50] : 	"temp_3_75um_nom" has 10.00% NaN values
DEBUG - 2023-04-13 12:48:04,861 [data_cleaners.py:50] : 	"temp_11_0um_nom" has 9.99% NaN values
DEBUG - 2023-04-13 12:48:04,862 [data_cleaners.py:50] : 	"temp_11_0um_nom_stddev_3x3" has 10.08% NaN values
DEBUG - 2023-04-13 12:48:04,862 [data_cleaners.py:50] : 	"cloud_probability" has 10.08% NaN values
DEBUG - 2023-04-13 12:48:04,863 [data_cleaners.py:50] : 	"cloud_fraction" has 10.08% NaN values
DEBUG - 2023-04-13 12:48:04,863 [data_cleaners.py:50] : 	"air_temperature" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:04,863 [data_cleaners.py:50] : 	"dew_point" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:04,864 [data_cleaners.py:50] : 	"relative_humidity" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:04,864 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:04,865 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:04,865 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 86.01% NaN values
DEBUG - 2023-04-13 12:48:04,866 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 86.05% NaN values
DEBUG - 2023-04-13 12:48:04,866 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2023-04-13 12:48:05,011 [data_cleaners.py:79] : Adding cloud type flag (e.g. flag=[night, clear, ice_cloud, water_cloud, bad_cloud])
DEBUG - 2023-04-13 12:48:05,049 [data_cleaners.py:105] : Feature flag column has these values: ['water_cloud' 'night' 'bad_cloud' 'clear' 'ice_cloud']
INFO - 2023-04-13 12:48:05,049 [data_cleaners.py:107] : Cleaning took 0.2 seconds
INFO - 2023-04-13 12:48:05,079 [data_cleaners.py:36] : 49.67% of timesteps are daylight
INFO - 2023-04-13 12:48:05,079 [data_cleaners.py:38] : 55.35% of daylight timesteps are cloudy
INFO - 2023-04-13 12:48:05,080 [data_cleaners.py:40] : 10.00% of daylight timesteps are missing cloud type
INFO - 2023-04-13 12:48:05,080 [data_cleaners.py:42] : 49.12% of cloudy daylight timesteps are missing cloud opd
INFO - 2023-04-13 12:48:05,080 [data_cleaners.py:44] : 49.24% of cloudy daylight timesteps are missing cloud reff
DEBUG - 2023-04-13 12:48:05,080 [data_cleaners.py:47] : Column NaN values:
DEBUG - 2023-04-13 12:48:05,081 [data_cleaners.py:50] : 	"gid" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,081 [data_cleaners.py:50] : 	"time_index" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,082 [data_cleaners.py:50] : 	"alpha" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,082 [data_cleaners.py:50] : 	"aod" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,082 [data_cleaners.py:50] : 	"asymmetry" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,083 [data_cleaners.py:50] : 	"cloud_type" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,083 [data_cleaners.py:50] : 	"cld_opd_dcomp" has 86.01% NaN values
DEBUG - 2023-04-13 12:48:05,084 [data_cleaners.py:50] : 	"cld_reff_dcomp" has 86.05% NaN values
DEBUG - 2023-04-13 12:48:05,084 [data_cleaners.py:50] : 	"ozone" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,084 [data_cleaners.py:50] : 	"solar_zenith_angle" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,085 [data_cleaners.py:50] : 	"ssa" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,085 [data_cleaners.py:50] : 	"surface_albedo" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,085 [data_cleaners.py:50] : 	"surface_pressure" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,086 [data_cleaners.py:50] : 	"total_precipitable_water" has 0.00% NaN values
DEBUG - 2023-04-13 12:48:05,086 [data_cleaners.py:53] : Interpolating opd and reff
DEBUG - 2023-04-13 12:48:05,163 [data_cleaners.py:79] : Adding cloud type flag (e.g. flag=[night, clear, ice_cloud, water_cloud, bad_cloud])
DEBUG - 2023-04-13 12:48:05,201 [data_cleaners.py:105] : Feature flag column has these values: ['water_cloud' 'night' 'bad_cloud' 'clear' 'ice_cloud']
INFO - 2023-04-13 12:48:05,201 [data_cleaners.py:107] : Cleaning took 0.2 seconds
DEBUG - 2023-04-13 12:48:05,201 [data_handlers.py:464] : Prepping validation data
DEBUG - 2023-04-13 12:48:05,212 [data_handlers.py:474] : Mask: shape=(188952,), sum=93851
DEBUG - 2023-04-13 12:48:05,220 [data_handlers.py:485] : Validation features: ['solar_zenith_angle', 'refl_0_65um_nom', 'refl_0_65um_nom_stddev_3x3', 'refl_3_75um_nom', 'temp_3_75um_nom', 'temp_11_0um_nom', 'temp_11_0um_nom_stddev_3x3', 'cloud_probability', 'cloud_fraction', 'air_temperature', 'dew_point', 'relative_humidity', 'total_precipitable_water', 'surface_albedo', 'flag']
INFO - 2023-04-13 12:48:05,221 [validator.py:107] : Predicting opd and reff
/projects/pxs/gbuster/nsrdb_env_2023/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.
  warnings.warn(
DEBUG - 2023-04-13 12:48:05,463 [validator.py:110] : Predicted data shape is (93851, 2)
DEBUG - 2023-04-13 12:48:05,488 [validator.py:158] : shapes: df_feature_val=(188952, 20), df_all_sky_val=(188952, 15)
INFO - 2023-04-13 12:48:05,505 [validator.py:179] : Calculating statistics
DEBUG - 2023-04-13 12:48:05,509 [validator.py:182] : Calcing stats for gids: [0, 1, 2, 3, 4, 5, 6, 7, 8]
DEBUG - 2023-04-13 12:48:05,509 [validator.py:339] : Loading data for 2016 / west
DEBUG - 2023-04-13 12:48:05,509 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:48:05,545 [validator.py:377] : 	Getting surfrad data for 0 from bon_2016.h5
DEBUG - 2023-04-13 12:48:06,211 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:48:06,245 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2016.h5
DEBUG - 2023-04-13 12:48:06,919 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:48:06,955 [validator.py:377] : 	Getting surfrad data for 2 from dra_2016.h5
DEBUG - 2023-04-13 12:48:07,632 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:48:07,668 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2016.h5
DEBUG - 2023-04-13 12:48:08,337 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:48:08,372 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2016.h5
DEBUG - 2023-04-13 12:48:09,044 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:48:09,080 [validator.py:377] : 	Getting surfrad data for 5 from psu_2016.h5
DEBUG - 2023-04-13 12:48:09,748 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:48:09,784 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2016.h5
DEBUG - 2023-04-13 12:48:10,451 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:48:10,487 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2016.h5
DEBUG - 2023-04-13 12:48:11,154 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:48:11,190 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2016.h5
DEBUG - 2023-04-13 12:48:11,859 [validator.py:339] : Loading data for 2017 / west
DEBUG - 2023-04-13 12:48:11,859 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:48:11,895 [validator.py:377] : 	Getting surfrad data for 0 from bon_2017.h5
DEBUG - 2023-04-13 12:48:12,567 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:48:12,603 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2017.h5
DEBUG - 2023-04-13 12:48:13,277 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:48:13,313 [validator.py:377] : 	Getting surfrad data for 2 from dra_2017.h5
DEBUG - 2023-04-13 12:48:13,987 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:48:14,020 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2017.h5
DEBUG - 2023-04-13 12:48:14,698 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:48:14,734 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2017.h5
DEBUG - 2023-04-13 12:48:15,407 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:48:15,440 [validator.py:377] : 	Getting surfrad data for 5 from psu_2017.h5
DEBUG - 2023-04-13 12:48:16,109 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:48:16,144 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2017.h5
DEBUG - 2023-04-13 12:48:16,820 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:48:16,854 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2017.h5
DEBUG - 2023-04-13 12:48:17,523 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:48:17,556 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2017.h5
DEBUG - 2023-04-13 12:48:18,229 [validator.py:339] : Loading data for 2018 / west
DEBUG - 2023-04-13 12:48:18,229 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:48:18,263 [validator.py:377] : 	Getting surfrad data for 0 from bon_2018.h5
DEBUG - 2023-04-13 12:48:18,935 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:48:18,969 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2018.h5
DEBUG - 2023-04-13 12:48:19,644 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:48:19,678 [validator.py:377] : 	Getting surfrad data for 2 from dra_2018.h5
DEBUG - 2023-04-13 12:48:20,355 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:48:20,389 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2018.h5
DEBUG - 2023-04-13 12:48:21,096 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:48:21,130 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2018.h5
DEBUG - 2023-04-13 12:48:21,809 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:48:21,843 [validator.py:377] : 	Getting surfrad data for 5 from psu_2018.h5
DEBUG - 2023-04-13 12:48:22,515 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:48:22,550 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2018.h5
DEBUG - 2023-04-13 12:48:23,223 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:48:23,258 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2018.h5
DEBUG - 2023-04-13 12:48:23,933 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:48:23,967 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2018.h5
DEBUG - 2023-04-13 12:48:24,646 [validator.py:339] : Loading data for 2019 / west
DEBUG - 2023-04-13 12:48:24,646 [validator.py:414] : 	Getting gid 0 from *.h5
DEBUG - 2023-04-13 12:48:24,696 [validator.py:377] : 	Getting surfrad data for 0 from bon_2019.h5
DEBUG - 2023-04-13 12:48:25,369 [validator.py:414] : 	Getting gid 1 from *.h5
DEBUG - 2023-04-13 12:48:25,420 [validator.py:377] : 	Getting surfrad data for 1 from tbl_2019.h5
DEBUG - 2023-04-13 12:48:26,098 [validator.py:414] : 	Getting gid 2 from *.h5
DEBUG - 2023-04-13 12:48:26,148 [validator.py:377] : 	Getting surfrad data for 2 from dra_2019.h5
DEBUG - 2023-04-13 12:48:26,823 [validator.py:414] : 	Getting gid 3 from *.h5
DEBUG - 2023-04-13 12:48:26,874 [validator.py:377] : 	Getting surfrad data for 3 from fpk_2019.h5
DEBUG - 2023-04-13 12:48:27,552 [validator.py:414] : 	Getting gid 4 from *.h5
DEBUG - 2023-04-13 12:48:27,603 [validator.py:377] : 	Getting surfrad data for 4 from gwn_2019.h5
DEBUG - 2023-04-13 12:48:28,285 [validator.py:414] : 	Getting gid 5 from *.h5
DEBUG - 2023-04-13 12:48:28,336 [validator.py:377] : 	Getting surfrad data for 5 from psu_2019.h5
DEBUG - 2023-04-13 12:48:29,003 [validator.py:414] : 	Getting gid 6 from *.h5
DEBUG - 2023-04-13 12:48:29,054 [validator.py:377] : 	Getting surfrad data for 6 from sxf_2019.h5
DEBUG - 2023-04-13 12:48:29,733 [validator.py:414] : 	Getting gid 7 from *.h5
DEBUG - 2023-04-13 12:48:29,784 [validator.py:377] : 	Getting surfrad data for 7 from sgp_2019.h5
DEBUG - 2023-04-13 12:48:30,460 [validator.py:414] : 	Getting gid 8 from *.h5
DEBUG - 2023-04-13 12:48:30,511 [validator.py:377] : 	Getting surfrad data for 8 from srrl_2019.h5
DEBUG - 2023-04-13 12:48:31,200 [validator.py:187] : Shapes: df_base_full=(946512, 6), df_surf_full=(946512, 4)
DEBUG - 2023-04-13 12:48:31,218 [validator.py:194] : Test set shapes: df_base_full=(188952, 6), df_surf_full=(188952, 4)
DEBUG - 2023-04-13 12:48:31,222 [validator.py:203] : Computing stats for gid: 0 bon
DEBUG - 2023-04-13 12:48:31,225 [validator.py:209] : Shapes: df_baseline=(21127, 6), df_surf=(21127, 4)
DEBUG - 2023-04-13 12:48:34,028 [validator.py:203] : Computing stats for gid: 1 tbl
DEBUG - 2023-04-13 12:48:34,031 [validator.py:209] : Shapes: df_baseline=(20964, 6), df_surf=(20964, 4)
DEBUG - 2023-04-13 12:48:36,821 [validator.py:203] : Computing stats for gid: 2 dra
DEBUG - 2023-04-13 12:48:36,824 [validator.py:209] : Shapes: df_baseline=(20878, 6), df_surf=(20878, 4)
DEBUG - 2023-04-13 12:48:39,606 [validator.py:203] : Computing stats for gid: 3 fpk
DEBUG - 2023-04-13 12:48:39,609 [validator.py:209] : Shapes: df_baseline=(21052, 6), df_surf=(21052, 4)
DEBUG - 2023-04-13 12:48:42,403 [validator.py:203] : Computing stats for gid: 4 gwn
DEBUG - 2023-04-13 12:48:42,407 [validator.py:209] : Shapes: df_baseline=(20842, 6), df_surf=(20842, 4)
DEBUG - 2023-04-13 12:48:45,192 [validator.py:203] : Computing stats for gid: 5 psu
DEBUG - 2023-04-13 12:48:45,195 [validator.py:209] : Shapes: df_baseline=(20901, 6), df_surf=(20901, 4)
DEBUG - 2023-04-13 12:48:47,988 [validator.py:203] : Computing stats for gid: 6 sxf
DEBUG - 2023-04-13 12:48:47,991 [validator.py:209] : Shapes: df_baseline=(21161, 6), df_surf=(21161, 4)
DEBUG - 2023-04-13 12:48:50,796 [validator.py:203] : Computing stats for gid: 7 sgp
DEBUG - 2023-04-13 12:48:50,799 [validator.py:209] : Shapes: df_baseline=(20930, 6), df_surf=(20930, 4)
DEBUG - 2023-04-13 12:48:53,592 [validator.py:203] : Computing stats for gid: 8 srrl
DEBUG - 2023-04-13 12:48:53,595 [validator.py:209] : Shapes: df_baseline=(21097, 6), df_surf=(21097, 4)
INFO - 2023-04-13 12:48:56,397 [validator.py:285] : Finished computing stats.
